<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Australian Cyber Security Events Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><text y='14' font-size='14'>üõ°Ô∏è</text></svg>" />
  <style>
    body { background-color: #f8f9fa; }
    .dashboard-header { background: linear-gradient(135deg, #2563eb, #1e40af); color: white; padding: 2rem 0; margin-bottom: 2rem; }
    .chart-container { background: white; border-radius: 12px; padding: 1.25rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 2rem; height: 380px; }
    .chart-title { font-size: 1.1rem; font-weight: 600; color: #374151; margin-bottom: 1rem; text-align: center; }
    .last-updated { color: #e5e7eb; font-size: 0.9rem; }
    .risk-matrix table { font-size: 0.9rem; }
    .risk-matrix .impact-label { width: 260px; text-align: left; font-weight: 600; }
    .risk-matrix .group-header { white-space: normal; }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
</head>
<body>
  <div class="dashboard-header">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-8">
          <h1 class="mb-0">Australian Cyber Security Events Dashboard</h1>
          <p class="mb-0 last-updated">Date Range: 2020-01-01 to 2025-11-26</p>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="row">
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Monthly Trends in Unique Event Count</div>
          <canvas id="monthlyTrendsChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Monthly Trends in Severity</div>
          <canvas id="severityTrendsChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Monthly Trends in Average Records Affected</div>
          <canvas id="recordsAffectedChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Monthly Trends in Event Type Mix</div>
          <canvas id="eventTypeMixChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Overall Mix of Entity Types</div>
          <canvas id="entityTypeChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Overall Event Type Mix (Pie)</div>
          <canvas id="overallEventTypePieChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Records Affected Histogram</div>
          <canvas id="recordsHistogramChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Severity per Month</div>
          <canvas id="maxSeverityChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Maximum Records Affected Per Month</div>
          <canvas id="maxRecordsChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Average Severity by Industry</div>
          <canvas id="severityByIndustryChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Average Severity by Attack Type</div>
          <canvas id="severityByAttackTypeChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Average Records Affected by Attack Type</div>
          <canvas id="recordsByAttackTypeChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container" style="height: 440px; overflow: hidden;">
          <div class="chart-title">Histogram of Monthly Unique Event Counts</div>
          <div id="monthlyCountsSubtitle" class="chart-subtitle" style="font-size: 0.95rem; color: #6b7280; margin-top: -8px; margin-bottom: 8px;"></div>
          <div style="height: 300px; position: relative;">
            <canvas id="monthlyCountsHistChart"></canvas>
          </div>
          <div id="monthlyCountsStats" class="mt-2" style="font-size: 0.9rem; color: #374151;"></div>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Database vs OAIC Official Notifications (Half-Yearly)</div>
          <canvas id="oaicComparisonChart"></canvas>
          <div id="oaicComparisonStats" class="mt-2" style="font-size: 0.9rem; color: #374151;"></div>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">OAIC Cyber Incidents vs Total Notifications</div>
          <canvas id="oaicCyberIncidentsChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">OAIC Attack Types Over Time</div>
          <canvas id="oaicAttackTypesChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title" id="oaicSectorsTitle">OAIC Top Affected Sectors (2019-2024)</div>
          <canvas id="oaicSectorsChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Database/OAIC Ratio by Sector</div>
          <canvas id="oaicSectorRatioChart"></canvas>
        </div>
      </div>
      <div class="col-lg-12 col-md-12">
        <div class="chart-container">
          <div class="chart-title">OAIC Individuals Affected Trends</div>
          <canvas id="oaicIndividualsAffectedChart"></canvas>
        </div>
      </div>
      <div class="col-lg-12 col-md-12">
        <div class="chart-container risk-matrix" style="height: auto;">
          <div class="chart-title d-flex justify-content-between align-items-center">
            <span>ASD Risk Matrix (All Years)</span>
            <span class="badge bg-secondary">Classifications: <span id="asdAllTotal">0</span></span>
          </div>
          <div id="asdRiskMatrixAll"></div>
        </div>
      </div>
      <div class="col-lg-12 col-md-12">
        <div class="chart-container risk-matrix" style="height: auto;">
          <div class="chart-title d-flex justify-content-between align-items-center">
            <span>ASD Risk Matrix (Current Year)</span>
            <span class="badge bg-secondary">Classifications: <span id="asdCurrentTotal">0</span></span>
          </div>
          <div id="asdRiskMatrixCurrent"></div>
        </div>
      </div>
      <div class="col-lg-12 col-md-12">
        <div class="chart-container" style="height: 500px;">
          <div class="chart-title">Event Type Correlation Matrix (Monthly Counts)</div>
          <canvas id="correlationMatrixChart"></canvas>
          <div id="correlationMatrixStats" class="mt-2" style="font-size: 0.9rem; color: #374151;"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Embedded data (static)
    const monthlyCounts = {"months": ["2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06", "2025-07", "2025-08", "2025-09", "2025-10", "2025-11"], "counts": [9, 11, 9, 2, 8, 19, 8, 9, 7, 3, 6, 8, 16, 9, 8, 5, 3, 4, 7, 3, 1, 5, 14, 8, 4, 8, 4, 3, 8, 3, 9, 15, 14, 9, 9, 8, 14, 3, 17, 16, 10, 12, 5, 9, 9, 5, 34, 21, 14, 12, 8, 27, 23, 11, 21, 14, 17, 15, 10, 11, 29, 16, 23, 15, 10, 22, 10, 22, 8, 13, 1], "total_events": 783, "avg_per_month": 11.028169014084508, "overdispersion": {"mean": 11.03, "variance": 47.03, "overdispersion_param": 4.264, "poisson_lambda": 11.03, "nb_n": 3.38, "nb_p": 0.235, "interpretation": "Negative Binomial"}};
    const severityTrends = {"months": ["2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06", "2025-07", "2025-08", "2025-09", "2025-10", "2025-11"], "data": {"Critical": [2, 0, 2, 0, 0, 1, 1, 0, 2, 0, 2, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 2, 0, 1, 0, 0, 0, 1, 0, 2, 1, 0, 0, 0, 0, 0, 4, 1, 1, 0, 1, 4, 1, 1, 3, 2, 1, 0, 0, 0, 3, 0, 1, 3, 0, 4, 0, 1, 1, 1, 1], "High": [7, 11, 6, 2, 5, 13, 6, 7, 3, 2, 4, 6, 15, 6, 7, 4, 3, 3, 5, 3, 1, 3, 11, 5, 3, 5, 3, 1, 6, 2, 8, 11, 10, 5, 6, 7, 11, 1, 11, 10, 7, 9, 2, 8, 8, 2, 23, 14, 12, 11, 4, 20, 18, 6, 15, 10, 13, 10, 7, 9, 19, 10, 15, 8, 6, 11, 7, 16, 4, 7, 0], "Medium": [0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 2, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 2, 1, 1, 0, 1, 1, 2, 0, 1, 0, 1, 1, 0, 0, 0, 0, 2, 3, 1, 2, 1, 0, 0, 3, 2, 3, 0, 0, 2, 3, 1, 3, 2, 0, 0, 1, 0, 1, 2, 1, 1, 0, 1, 2, 1, 1, 0, 2, 0], "Unknown": [0, 0, 0, 0, 2, 4, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 2, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 2, 3, 2, 3, 1, 3, 1, 4, 1, 1, 1, 2, 1, 1, 0, 5, 3, 1, 1, 1, 0, 3, 1, 1, 2, 3, 4, 3, 1, 5, 5, 6, 4, 3, 5, 2, 4, 1, 3, 0], "Low": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}};
    const recordsAffected = {"months": ["2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06", "2025-07", "2025-08", "2025-09", "2025-10", "2025-11"], "averages": [66296.0, 10006.666666666666, 264500.0, 7050.0, 181406.66666666666, 14224061.166666666, 11086209.0, 210000.0, 22400154.25, 114000000.0, 500.0, 155675.0, 1513645.4545454546, 1704833.3333333333, 31500.0, 31676.0, 350037000.0, 1500.0, 1244333.3333333333, 1200000.0, 5015750.0, 802990.75, 2744044.8, 416781.5, 262571.4285714286, 187611.33333333334, 500.0, 108146.2, 193000.0, 545453.3333333334, 7244615.384615385, 5173614.454545454, 1664000.0, 3564.0, 27593.666666666668, 1918825.2727272727, 10526000.0, 1233210.0, 570029.0, 965611.1111111111, 104000.0, 132500.0, 365800.0, 15764.5, 3975509.1304347827, 65285.71428571428, 8754000.0, 4692060.0, 8966800.0, 34658812.0, 7828373.857142857, 168119.75, 2103999.25, 101032.0, 25920072.85714286, 229342.2857142857, 549100.0, 112049.75, 328274.3333333333, 62476.0, 657902.4615384615, 873514.2857142857, 8094.0, 8205944.533333333, 159333.33333333334, 121348.6, 1429680.75, 44069.25, 80.0], "medians": [40000.0, 10000.0, 186000.0, 7050.0, 100000.0, 15950000.0, 900.0, 54000.0, 6200000.0, 114000000.0, 500.0, 52650.0, 31000.0, 9500.0, 31500.0, 9828.0, 350037000.0, 1500.0, 1850000.0, 1200000.0, 5015750.0, 80000.0, 80000.0, 369000.0, 223000.0, 13000.0, 500.0, 50000.0, 193000.0, 46980.0, 9700000.0, 5700000.0, 80000.0, 3564.0, 8927.5, 16000.0, 14000000.0, 1125000.0, 18000.0, 1240000.0, 104000.0, 161500.0, 193000.0, 6468.5, 30000.0, 100000.0, 792000.0, 559120.0, 12900000.0, 12900000.0, 1331971.0, 59239.5, 759808.5, 4000.0, 74373.0, 296124.0, 800000.0, 22964.5, 9000.0, 13967.0, 20000.0, 20000.0, 8094.0, 5700000.0, 98000.0, 7500.0, 9311.5, 13819.5, 80.0], "confidence_intervals": [[53036.8, 79555.2], [8005.333333333333, 12008.0], [211600.0, 317400.0], [5640.0, 8460.0], [145125.3333333333, 217688.0], [11379248.933333334, 17068873.4], [8868967.2, 13303450.8], [168000.0, 252000.0], [17920123.4, 26880185.1], [91200000.0, 136800000.0], [400.0, 600.0], [124540.0, 186810.0], [1210916.3636363638, 1816374.5454545454], [1363866.6666666665, 2045800.0], [25200.0, 37800.0], [25340.8, 38011.2], [280029600.0, 420044400.0], [1200.0, 1800.0], [995466.6666666666, 1493200.0], [960000.0, 1440000.0], [4012600.0, 6018900.0], [642392.6, 963588.9], [2195235.84, 3292853.76], [333425.2, 500137.8], [210057.14285714287, 315085.7142857143], [150089.06666666668, 225133.6], [400.0, 600.0], [86516.95999999999, 129775.44], [154400.0, 231600.0], [436362.6666666667, 654544.0], [5795692.307692308, 8693538.461538462], [4138891.5636363635, 6208337.345454545], [1331200.0, 1996800.0], [2851.2, 4276.8], [22074.933333333334, 33112.4], [1535060.2181818183, 2302590.327272727], [8420800.0, 12631200.0], [986568.0, 1479852.0], [456023.2, 684034.8], [772488.8888888889, 1158733.3333333335], [83200.0, 124800.0], [106000.0, 159000.0], [292640.0, 438960.0], [12611.6, 18917.4], [3180407.304347826, 4770610.956521739], [52228.57142857143, 78342.85714285714], [7003200.0, 10504800.0], [3753648.0, 5630472.0], [7173440.0, 10760160.0], [27727049.6, 41590574.4], [6262699.085714286, 9394048.628571428], [134495.8, 201743.7], [1683199.4, 2524799.1], [80825.6, 121238.4], [20736058.285714287, 31104087.42857143], [183473.82857142857, 275210.7428571429], [439280.0, 658920.0], [89639.8, 134459.7], [262619.4666666667, 393929.19999999995], [49980.8, 74971.2], [526321.9692307692, 789482.9538461538], [698811.4285714285, 1048217.1428571428], [6475.2, 9712.8], [6564755.626666667, 9847133.44], [127466.66666666667, 191200.0], [97078.88, 145618.32], [1143744.6, 1715616.9], [35255.4, 52883.1], [64.0, 96.0]], "sample_sizes": [5, 3, 4, 2, 3, 6, 7, 5, 4, 1, 1, 4, 11, 6, 2, 3, 2, 1, 3, 1, 2, 12, 5, 4, 7, 3, 1, 5, 1, 6, 13, 11, 6, 2, 6, 11, 12, 10, 5, 9, 2, 4, 5, 4, 23, 7, 3, 4, 3, 21, 14, 4, 8, 3, 7, 7, 3, 4, 9, 6, 13, 7, 1, 15, 3, 10, 4, 4, 1]};
    const eventTypeMix = {"months": ["2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06", "2025-07", "2025-08", "2025-09", "2025-10", "2025-11"], "types": {"Data Breach": [6, 6, 4, 2, 3, 7, 7, 6, 4, 1, 3, 7, 8, 4, 1, 1, 1, 4, 2, 2, 1, 3, 9, 4, 4, 4, 2, 1, 4, 1, 9, 10, 11, 3, 6, 5, 9, 1, 10, 11, 8, 10, 4, 6, 6, 4, 15, 9, 7, 7, 3, 21, 17, 2, 10, 1, 6, 7, 4, 3, 10, 4, 13, 4, 3, 10, 2, 6, 0, 4, 0], "Ransomware": [3, 3, 2, 0, 2, 5, 1, 2, 0, 1, 3, 0, 1, 3, 4, 2, 1, 0, 1, 1, 0, 1, 4, 3, 0, 2, 0, 1, 3, 1, 0, 3, 0, 2, 0, 1, 2, 1, 1, 4, 1, 1, 0, 2, 2, 0, 5, 6, 5, 4, 3, 6, 3, 8, 7, 7, 9, 4, 4, 6, 13, 5, 4, 7, 4, 7, 2, 9, 5, 6, 1], "Other": [0, 1, 0, 0, 2, 2, 0, 1, 1, 1, 0, 1, 2, 1, 2, 1, 0, 0, 2, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 3, 2, 2, 2, 3, 1, 4, 1, 1, 1, 0, 0, 1, 0, 7, 4, 1, 0, 0, 0, 2, 1, 3, 4, 2, 4, 0, 1, 5, 5, 5, 3, 3, 5, 2, 3, 1, 2, 0], "Phishing": [0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0], "State Sponsored Attack": [0, 0, 1, 0, 1, 2, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0], "Vulnerability Exploit": [0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0], "Infrastructure Attack": [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 4, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], "Malware": [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], "Financial Fraud": [0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "Supply Chain Attack": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "Denial Of Service": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0], "Unknown": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0]}};
    const overallEventTypeMix = {"labels": ["Data Breach", "Ransomware", "Other", "State Sponsored Attack", "Infrastructure Attack", "Malware", "Vulnerability Exploit", "Phishing", "Denial Of Service", "Financial Fraud", "Unknown", "Supply Chain Attack"], "counts": [393, 210, 108, 18, 16, 10, 9, 8, 5, 3, 2, 1]};
    const entityTypes = {"types": [{"type": "Unknown", "events": 367, "entities": 367}, {"type": "Technology", "events": 92, "entities": 92}, {"type": "Healthcare", "events": 82, "entities": 82}, {"type": "Others", "events": 55, "entities": 55}, {"type": "Government & Defense", "events": 52, "entities": 52}, {"type": "Financial Services", "events": 46, "entities": 46}, {"type": "Education", "events": 28, "entities": 28}, {"type": "Transportation", "events": 25, "entities": 25}, {"type": "Infrastructure", "events": 13, "entities": 13}, {"type": "Professional Services", "events": 13, "entities": 13}, {"type": "Telecommunications", "events": 6, "entities": 6}, {"type": "Not for Profit", "events": 4, "entities": 4}]};
    const recordsHistogram = {"bins": ["1-10", "11-100", "101-1K", "1K-10K", "10K-100K", "100K-1M", "1M-10M", "10M+"], "frequencies": [0, 9, 34, 61, 107, 72, 67, 54]};
    const maxRecordsPerMonth = {"months": ["2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06", "2025-07", "2025-08", "2025-09", "2025-10", "2025-11"], "max_records": [186000, 19900, 500000, 8800, 444000, 33000000, 77159696, 444000, 77200000, 114000000, 500, 515000, 11000000, 5700000, 31500, 80000, 700000000, 1500, 1850000, 1200000, 10000000, 8200000, 8200000, 928760, 500000, 548000, 500, 285631, 193000, 2200000, 11000000, 11000000, 9700000, 6000, 130000, 12900000, 14000000, 2500000, 2800000, 1240000, 193000, 193000, 1240000, 50000, 12900000, 100000, 25000000, 17600000, 14000000, 560000000, 17643173, 524000, 8500000, 299006, 150000000, 400000, 800000, 400000, 2369481, 318150, 5700000, 6000000, 8094, 64000000, 310000, 430000, 5700000, 148538, 80], "titles": ["Advances in technology and efforts to protect important personal ...", "University of Tasmania IT bungle leads to mass student data breach", "Sensitive business addresses among 500,000 published in COVID data breach", "Confidential details of entire WA Police Force accessed in 'startling' audit breach, CCC finds", "Australian universities investigating 'deeply concerning' hack of controversial exam software", "Google Chrome Security Breach: 33 Million Downloads Of Spyware", "Nitro PDF suffers massive data breach, exposing Microsoft, Google, Amazon documents", "Hackers hit university online exam tool", "Untitled Event", "Gravatar profile add-on leaks data on millions of users", "Data theft at Australian Securities and Investments Commission (ASIC)", "TfNSW hit by another data breach", "Telstra explains how internal data breach exposed more than 130,000 customers' details", "SITA data breach affects millions of airline passengers", "UnitingCare Queensland Ransomware Attack Impacts Major ...", "South Australian Government Payroll Data Breach via Frontier Software Ransomware Attack", "LinkedIn data from 700 million users for sale on hacking forum", "Kaseya VSA Supply-Chain Ransomware Attack | Cyber.gov.au", "The Good Guys customers possibly affected by data breach at former third-party provider My Rewards", "Cybersecurity experts weigh in on GoDaddy data breach", "Twitch hack reveals multi-million-dollar sums top streamers earn from playing computer games", "Okta says third-party breach may have impacted up to 366 customers", "Afterpay shareholders sue Dorsey\u2019s Block for breach disclosure", "Vinomofo did not protect personal information from security risks, Privacy Commissioner finds", "NSW nurses strike as data breach defended", "Microsoft Data Breach (Australia)", "Australian Healthcare Sector Targeted by Ransomware and Remote Access Tool Attacks", "Leak of Nauru Police Force Files Related to Australian Offshore Processing", "Icare data breach due to \u2018human error\u2019, agency says", "Woolworths MyDeal Data Breach", "Australia Blames Russian Hacker for Major Cyber Attack - The ...", "Optus fined $826,000 over Coles Mobile scam security breach | The ...", "Chaos at Brisbane Airport after security breach evacuates Virgin ...", "Energy company AGL reports cyber incident | Insurance Business ...", "Telstra blames privacy breach on 'database misalignment'", "Data breach | IDMatch", "Recent Data Breaches \u2013 advice for foreign passport holders", "1.2 million customers caught up in Dymocks hack", "Amazon Says Employee Data Impacted In Third-Party Breach", "Dymocks warns customers of data breach after account information leaked on dark web", "Pizza Hut Australia Data Breach", "Pizza Hut says nearly two-hundred thousand customers affected by ...", "Dymocks links data breach to \"external data partner\"", "Charity donor details\u2026 - Institute of Community Directors Australia", "MediSecure Ransomware Attack and Massive Health Data Breach", "Nissan A/NZ's outsourced cyber incident call centre breached", "DJI suffers alleged data breach at the hands of R00TK1T", "Ticketek customer details exposed in cybersecurity breach | Data ...", "Sale of 14 Million Australian Emails and Addresses on Hacking Forum", "Live Nation probing Ticketmaster hack", "Cyberattacks Australia 2024 | KonBriefing.com", "Op-Ed: Patties Foods\u2019 \u2018data leak\u2019 proves cyber reporting needs to do better", "Widespread outages relating to CrowdStrike software update ...", "Fortinet suffers third-party data breach affecting Asia-Pacific ...", "MoneyGram confirms data breach after major outage", "Exclusive: Funksec ransomware gang allegedly targets pair of Aussie companies", "Navigating the privacy risks of electric vehicles - Law Society Journal", "SquareX reveals critical breach of Cyberhaven extension", "BREAKING NEWS:JB Hi FI Denies Massive Cyber Attack Claim", "Cybersecurity Incident Impacting Compumedics Limited ...", "Beyond Qantas' data leak, Australian finance companies are also at ...", "Queensland data security breach exposes data of thousands as ...", "Exclusive: Legal Practice Board of Western Australia confirms Dire Wolf ransomware attack", "McDonald's AI chatbot hacked leaving Aussie job applicants exposed", "iiNet cyber incident | The Telecommunications Industry Ombudsman", "Update on response to cyber incident - ReadyTech Holdings Limited ...", "Update on VETtrak Cyber Incident - METS Training Services", "Australian estate agencies hit by Radar ransomware attack | 3 Point ...", "INC Ransom ransomware attack on Facade Innovations"], "entities": ["New South Wales Department of Customer Service", "University of Tasmania", "Department of Customer Service, New South Wales Government", "Office of the Auditor General for Western Australia", "ProctorU (vendor breach affecting multiple Australian universities)", "Alphabet Inc.", "Nitro Software Inc.", "ProctorU LLC", "Nitro Software Limited", "Automattic Inc.", "Australian Securities and Investments Commission", "Transport for New South Wales", "Telstra Corporation Limited", "Soci\u00e9t\u00e9 Internationale de T\u00e9l\u00e9communications A\u00e9ronautiques SC", "UnitingCare Queensland", "Government of South Australia", "LinkedIn Corporation", "Kaseya Limited", "Pegasus Group Australia Pty Ltd (now My Rewards Pty Ltd)", "GoDaddy Inc.", "Twitch Interactive, Inc.", "Okta, Inc.", "Afterpay Limited", "Vinomofo Pty Ltd", "NSW Government", "Microsoft Corporation", "Unknown", "Nauru Police Force", "Insurance and Care NSW", "MyDeal.com.au Pty Ltd", "Medibank Private Limited", "Optus Mobile Pty Limited", "Brisbane Airport Corporation Pty Limited", "AGL Energy Limited", "Telstra Corporation Limited", "MediSecure Pty Ltd", "Latitude Financial Services Pty Ltd", "Unknown", "Amazon.com, Inc.", "Dymocks Holdings Pty Ltd", "Pizza Hut Australia Pty Ltd", "Pizza Pan Group Pty Ltd", "Unknown", "Institute of Community Directors Australia Limited", "MediSecure Limited", "Nissan Motor Co. (Australia) Pty Ltd", "SZ DJI Technology Co., Ltd.", "TEG Pty Ltd", "Unknown", "Live Nation Entertainment, Inc.", "Victoria Racing Club Limited", "Patties Foods Limited", "CrowdStrike Holdings, Inc.", "Fortinet, Inc.", "MoneyGram International Inc.", "Fresh Produce Safety Centre Ltd", "Volkswagen AG", "Cyberhaven, Inc.", "JB Hi-Fi Limited", "Compumedics Limited", "Qantas Airways Limited", "Unknown", "Legal Practice Board of Western Australia", "McDonald's Australia Limited", "iiNet Limited", "ReadyTech Holdings Limited", "METS Training Services Pty Ltd", "Malibu Boats Australia Pty Ltd", "Facade Innovations Pty Ltd"]};
    const recordsByAttackType = {"attack_types": ["Data Breach", "Ransomware", "Other", "Malware", "State Sponsored Attack", "Infrastructure Attack", "Phishing", "Financial Fraud", "Vulnerability Exploit", "Supply Chain Attack"], "avg_records": [9600973.911538461, 2060608.75, 2659513.65, 8272750.0, 6312366.5, 1398600.0, 33000.0, 15000.0, 4683.333333333333, 1500.0]};
    const monthlyCountsStats = {"bins": ["1 - 4", "4 - 7", "7 - 10", "10 - 14", "14 - 17", "17 - 20", "20 - 24", "24 - 27", "27 - 30", "30 - 34"], "frequencies": [12, 7, 23, 11, 8, 1, 6, 1, 1, 1], "mean": 11.028169014084508, "variance": 46.3654036897441, "k_estimate": 3.44170993909114, "model": "Over-dispersed (likely Negative Binomial)", "overdispersion": {"mean": 11.03, "variance": 47.03, "overdispersion_param": 4.264, "poisson_lambda": 11.03, "nb_n": 3.38, "nb_p": 0.235, "interpretation": "Negative Binomial"}};
    const eventTypeCorrelation = {"labels": ["Data Breach", "Ransomware", "Other", "Phishing", "State Sponsored Attack", "Vulnerability Exploit", "Infrastructure Attack", "Malware", "Denial Of Service"], "correlation_matrix": [[1.0, 0.251, 0.369, 0.107, 0.017, 0.054, 0.162, 0.166, -0.118], [0.251, 1.0, 0.509, 0.173, 0.094, 0.197, 0.169, 0.04, 0.066], [0.369, 0.509, 1.0, 0.223, 0.193, 0.333, 0.44, 0.095, -0.092], [0.107, 0.173, 0.223, 1.0, -0.092, 0.4, 0.243, 0.086, 0.25], [0.017, 0.094, 0.193, -0.092, 1.0, 0.232, -0.003, 0.155, -0.141], [0.054, 0.197, 0.333, 0.4, 0.232, 1.0, 0.431, 0.442, 0.226], [0.162, 0.169, 0.44, 0.243, -0.003, 0.431, 1.0, 0.146, -0.012], [0.166, 0.04, 0.095, 0.086, 0.155, 0.442, 0.146, 1.0, 0.279], [-0.118, 0.066, -0.092, 0.25, -0.141, 0.226, -0.012, 0.279, 1.0]], "min_correlation": -0.141, "max_correlation": 1.0};
    const oaicComparison = {"periods": ["2020 H1", "2020 H2", "2021 H1", "2021 H2", "2022 H1", "2022 H2", "2023 H1", "2023 H2", "2024 H1", "2024 H2", "2025 H1", "2025 H2"], "database_counts": [58, 41, 45, 38, 30, 64, 72, 83, 95, 88, 115, 54], "oaic_counts": [447, 512, 530, 436, 250, 350, 409, 483, 527, 595, null, null], "oaic_available": 10, "database_available": 12, "prorata_period": null, "prorata_estimate": null, "prorata_actual": null};
    const oaicCyberIncidents = {"periods": ["2019 Q1", "2019 Q2", "2019 H2", "2020 H1", "2020 H2", "2021 H1", "2021 H2", "2022 H1", "2022 H2", "2023 H1", "2023 H2", "2024 H1", "2024 H2"], "cyber_incidents": [null, null, 71, 308, 212, 192, 173, 162, 222, 172, 211, 200, 247], "total_notifications": [215, 245, 106, 447, 512, 530, 436, 250, 350, 409, 483, 527, 595]};
    const oaicAttackTypes = {"periods": ["2019 Q1", "2019 Q2", "2019 H2", "2020 H1", "2020 H2", "2021 H1", "2021 H2", "2022 H1", "2022 H2", "2023 H1", "2023 H2", "2024 H1", "2024 H2"], "attack_types": {"ransomware": [7, 8, 6, 15, 17, 24, 23, 51, 64, null, null, null, null], "phishing": [20, 4, 36, 36, 25, 30, 32, 42, null, 331, 591, null, null], "hacking": [13, 8, 6, 13, 14, 9, 8, 13, null, 164, null, null, null], "malware": [13, 2, 10, 4, 7, 5, 3, 9, 109, 133, 10, 105, 122], "brute_force": [null, null, null, null, null, null, null, 200, null, null, null, null, null], "compromised_credentials": [null, 43, null, null, null, null, null, null, null, null, null, null, null]}};
    const oaicSectors = {"sectors": ["Retail", "Education", "Australian government", "Health", "Finance"], "oaic_counts": [1066, 458, 421, 385, 114], "database_counts": [32, 23, 46, 65, 37], "ratios": [0.03, 0.05, 0.11, 0.17, 0.32], "sector_count": 5};
    const oaicIndividualsAffected = {"periods": ["2019 Q1", "2019 Q2", "2019 H2", "2020 H1", "2020 H2", "2021 H1", "2021 H2", "2022 H1", "2022 H2", "2023 H1", "2023 H2", "2024 H1", "2024 H2"], "averages": [36993, 9479, 340, 486, 20117, 523998, 745, 134, 1328, 845, 9080, 107123, 15357], "medians": [null, null, null, null, null, null, null, null, null, null, null, 341, 182], "db_averages": [null, null, 90536666.66666667, 3796616.8260869565, 12858058.181818182, 30296297.0, 1596754.7083333333, 228675.7619047619, 3739072.022727273, 3644506.8723404254, 2100528.177777778, 18572151.12244898, 6321140.46875]};
    const asdRiskAll = {"impact_types": ["Sustained disruption of essential systems and associated services", "Extensive compromise", "Isolated compromise", "Coordinated low-level malicious attack", "Low-level malicious attack", "Unsuccessful low-level malicious attack"], "stakeholder_groups": ["Member(s) of the public", "Small organisation(s) / Sole traders", "Medium-sized organisation(s) / Schools / Local government", "State government / Academia/R&D / Large organisation(s) / Supply chain", "Federal government / Government shared services / Regulated critical infrastructure", "National security / Systems of National Significance"], "matrix": [{"impact_type": "Sustained disruption of essential systems and associated services", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 1, "State government / Academia/R&D / Large organisation(s) / Supply chain": 18, "Federal government / Government shared services / Regulated critical infrastructure": 25, "National security / Systems of National Significance": 2}}, {"impact_type": "Extensive compromise", "counts": {"Member(s) of the public": 214, "Small organisation(s) / Sole traders": 1, "Medium-sized organisation(s) / Schools / Local government": 14, "State government / Academia/R&D / Large organisation(s) / Supply chain": 254, "Federal government / Government shared services / Regulated critical infrastructure": 80, "National security / Systems of National Significance": 15}}, {"impact_type": "Isolated compromise", "counts": {"Member(s) of the public": 83, "Small organisation(s) / Sole traders": 19, "Medium-sized organisation(s) / Schools / Local government": 124, "State government / Academia/R&D / Large organisation(s) / Supply chain": 347, "Federal government / Government shared services / Regulated critical infrastructure": 72, "National security / Systems of National Significance": 0}}, {"impact_type": "Coordinated low-level malicious attack", "counts": {"Member(s) of the public": 1, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 1, "Federal government / Government shared services / Regulated critical infrastructure": 4, "National security / Systems of National Significance": 0}}, {"impact_type": "Low-level malicious attack", "counts": {"Member(s) of the public": 4, "Small organisation(s) / Sole traders": 3, "Medium-sized organisation(s) / Schools / Local government": 9, "State government / Academia/R&D / Large organisation(s) / Supply chain": 15, "Federal government / Government shared services / Regulated critical infrastructure": 11, "National security / Systems of National Significance": 0}}, {"impact_type": "Unsuccessful low-level malicious attack", "counts": {"Member(s) of the public": 79, "Small organisation(s) / Sole traders": 11, "Medium-sized organisation(s) / Schools / Local government": 31, "State government / Academia/R&D / Large organisation(s) / Supply chain": 111, "Federal government / Government shared services / Regulated critical infrastructure": 58, "National security / Systems of National Significance": 7}}], "total_classifications": 1614, "max_value": 347, "year": null};
    const asdRiskCurrent = {"impact_types": ["Sustained disruption of essential systems and associated services", "Extensive compromise", "Isolated compromise", "Coordinated low-level malicious attack", "Low-level malicious attack", "Unsuccessful low-level malicious attack"], "stakeholder_groups": ["Member(s) of the public", "Small organisation(s) / Sole traders", "Medium-sized organisation(s) / Schools / Local government", "State government / Academia/R&D / Large organisation(s) / Supply chain", "Federal government / Government shared services / Regulated critical infrastructure", "National security / Systems of National Significance"], "matrix": [{"impact_type": "Sustained disruption of essential systems and associated services", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 0, "Federal government / Government shared services / Regulated critical infrastructure": 0, "National security / Systems of National Significance": 0}}, {"impact_type": "Extensive compromise", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 0, "Federal government / Government shared services / Regulated critical infrastructure": 0, "National security / Systems of National Significance": 0}}, {"impact_type": "Isolated compromise", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 0, "Federal government / Government shared services / Regulated critical infrastructure": 0, "National security / Systems of National Significance": 0}}, {"impact_type": "Coordinated low-level malicious attack", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 0, "Federal government / Government shared services / Regulated critical infrastructure": 0, "National security / Systems of National Significance": 0}}, {"impact_type": "Low-level malicious attack", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 0, "Federal government / Government shared services / Regulated critical infrastructure": 0, "National security / Systems of National Significance": 0}}, {"impact_type": "Unsuccessful low-level malicious attack", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 0, "Federal government / Government shared services / Regulated critical infrastructure": 0, "National security / Systems of National Significance": 0}}], "total_classifications": 0, "max_value": 0, "year": 2025};

    const colors = {
      primary: '#2563eb',
      secondary: '#10b981',
      success: '#10b981',
      warning: '#f59e0b',
      danger: '#ef4444',
      info: '#06b6d4',
      severity: {
        'Critical': '#dc2626', 'High': '#ea580c', 'Medium': '#ca8a04', 'Low': '#16a34a', 'Unknown': '#6b7280'
      }
    };

    function renderRiskMatrix(targetId, matrixData, totalId) {
      const container = document.getElementById(targetId);
      const totalElement = totalId ? document.getElementById(totalId) : null;
      if (!container) return;

      if (!matrixData || !Array.isArray(matrixData.matrix) || matrixData.matrix.length === 0) {
        container.innerHTML = '<p class="text-muted mb-0">No ASD risk classifications available.</p>';
        if (totalElement) totalElement.textContent = '0';
        return;
      }

      const groups = matrixData.stakeholder_groups || [];
      const matrixRows = matrixData.matrix;
      const maxValue = matrixData.max_value || 0;

      const colorForValue = (value) => {
        if (!value || !maxValue) return '';
        const opacity = 0.18 + 0.72 * (value / maxValue);
        const textColor = opacity > 0.45 ? '#ffffff' : '#111827';
        return `background-color: rgba(37, 99, 235, ${opacity.toFixed(3)}); color: ${textColor};`;
      };

      let html = '<div class="table-responsive"><table class="table table-sm table-bordered align-middle text-center mb-1">';
      html += '<thead><tr><th class="text-start">Impact Type</th>';
      groups.forEach(group => { html += `<th class="group-header">${group}</th>`; });
      html += '</tr></thead><tbody>';

      matrixRows.forEach(row => {
        html += `<tr><th scope="row" class="text-start impact-label">${row.impact_type}</th>`;
        groups.forEach(group => {
          const value = (row.counts && row.counts[group]) ? row.counts[group] : 0;
          const display = value > 0 ? value : '';
          const style = colorForValue(value);
          html += `<td style="${style}">${display}</td>`;
        });
        html += '</tr>';
      });

      html += '</tbody></table></div>';
      container.innerHTML = html;

      if (totalElement) {
        totalElement.textContent = (matrixData.total_classifications || 0).toLocaleString();
      }
    }

    renderRiskMatrix('asdRiskMatrixAll', asdRiskAll, 'asdAllTotal');
    renderRiskMatrix('asdRiskMatrixCurrent', asdRiskCurrent, 'asdCurrentTotal');

    // 1) Monthly Trends (line) with trend line
    (function() {
      const counts = monthlyCounts.counts;
      const n = counts.length;

      // Calculate linear regression for trend line
      let sumX = 0, sumY = 0, sumXY = 0, sumXX = 0;
      for (let i = 0; i < n; i++) {
        sumX += i;
        sumY += counts[i];
        sumXY += i * counts[i];
        sumXX += i * i;
      }

      const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);
      const intercept = (sumY - slope * sumX) / n;

      // Generate trend line data
      const trendLine = [];
      for (let i = 0; i < n; i++) {
        trendLine.push(slope * i + intercept);
      }

      new Chart(document.getElementById('monthlyTrendsChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: monthlyCounts.months,
          datasets: [
            {
              label: 'Unique Events',
              data: counts,
              borderColor: colors.primary,
              backgroundColor: '#2563eb20',
              fill: true,
              tension: 0.4,
              order: 2
            },
            {
              label: 'Trend',
              data: trendLine,
              borderColor: '#dc2626',
              backgroundColor: 'transparent',
              borderWidth: 2,
              borderDash: [5, 5],
              fill: false,
              tension: 0,
              pointRadius: 0,
              order: 1
            }
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              position: 'top'
            }
          },
          scales: {
            y: { beginAtZero: true },
            x: { title: { display: true, text: 'Month' }}
          }
        }
      });
    })();

    // 2) Severity Trends (stacked bar)
    const sevDatasets = Object.keys(severityTrends.data).map(sev => ({
      label: sev,
      data: severityTrends.data[sev],
      backgroundColor: colors.severity[sev] || '#6b7280',
      borderColor: colors.severity[sev] || '#6b7280',
    }));
    new Chart(document.getElementById('severityTrendsChart').getContext('2d'), {
      type: 'bar',
      data: { labels: severityTrends.months, datasets: sevDatasets },
      options: {
        responsive: true, maintainAspectRatio: false,
        plugins: { legend: { position: 'top' } },
        scales: {
          x: { stacked: true, title: { display: true, text: 'Month' }},
          y: { stacked: true, beginAtZero: true, title: { display: true, text: 'Events' }}
        }
      }
    });

    // 3) Records Affected (line, log scale) with Average and Median
    new Chart(document.getElementById('recordsAffectedChart').getContext('2d'), {
      type: 'line',
      data: {
        labels: recordsAffected.months,
        datasets: [
          {
            label: 'Average Records Affected',
            data: recordsAffected.averages,
            borderColor: colors.secondary,
            backgroundColor: '#10b98120',
            fill: false,
            tension: 0.4,
            borderWidth: 2
          },
          {
            label: 'Median Records Affected',
            data: recordsAffected.medians,
            borderColor: colors.primary,
            backgroundColor: '#2563eb20',
            fill: false,
            tension: 0.4,
            borderWidth: 2,
            borderDash: [5, 5]
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: true,
            position: 'top'
          }
        },
        scales: {
          y: {
            type: 'logarithmic',
            beginAtZero: true,
            title: { display: true, text: 'Records (log)' }
          },
          x: {
            title: { display: true, text: 'Month' }
          }
        }
      }
    });

    // 4) Event Type Mix (stacked bar)
    function generateUniqueColors(n) {
      // Golden angle based distinct colors
      const colors = [];
      const golden = 137.508;
      for (let i = 0; i < n; i++) {
        const hue = (i * golden) % 360;
        const sat = 70;
        const light = 50;
        colors.push(`hsl(${hue}, ${sat}%, ${light}%)`);
      }
      return colors;
    }
    const etKeys = Object.keys(eventTypeMix.types);
    const uniqueColors = generateUniqueColors(etKeys.length);
    const etDatasets = etKeys.map((t, i) => ({
      label: t,
      data: eventTypeMix.types[t],
      backgroundColor: uniqueColors[i],
      borderColor: uniqueColors[i]
    }));
    new Chart(document.getElementById('eventTypeMixChart').getContext('2d'), {
      type: 'bar',
      data: { labels: eventTypeMix.months, datasets: etDatasets },
      options: {
        responsive: true, maintainAspectRatio: false,
        plugins: { legend: { position: 'top' }},
        scales: { x: { stacked: true }, y: { stacked: true, beginAtZero: true }}
      }
    });

    // 5) Entity Type Distribution (doughnut)
    const entityLabels = entityTypes.types.map(t => t.type);
    const entityValues = entityTypes.types.map(t => t.events);
    new Chart(document.getElementById('entityTypeChart').getContext('2d'), {
      type: 'doughnut',
      data: { labels: entityLabels, datasets: [{ data: entityValues, backgroundColor: entityLabels.map((_, i) => `hsl(${(i*360/entityLabels.length)||0},70%,50%)`) }]},
      options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right' }}}
    });

    // 6) Overall Event Type Mix (pie)
    (function(){
      const labels = overallEventTypeMix.labels || [];
      const counts = overallEventTypeMix.counts || [];
      const colors = generateUniqueColors(labels.length);
      new Chart(document.getElementById('overallEventTypePieChart').getContext('2d'), {
        type: 'pie',
        data: { labels, datasets: [{ data: counts, backgroundColor: colors, borderColor: colors }]},
        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right' }}}
      });
    })();

    // 6) Records Histogram (bar)
    new Chart(document.getElementById('recordsHistogramChart').getContext('2d'), {
      type: 'bar',
      data: { labels: recordsHistogram.bins, datasets: [{ label: 'Frequency', data: recordsHistogram.frequencies, backgroundColor: '#06b6d480', borderColor: '#06b6d4' }]},
      options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }}, scales: { y: { beginAtZero: true }}}
    });

    // 7) Histogram of Monthly Unique Event Counts + dispersion stats
    new Chart(document.getElementById('monthlyCountsHistChart').getContext('2d'), {
      type: 'bar',
      data: { labels: monthlyCountsStats.bins, datasets: [{ label: 'Months', data: monthlyCountsStats.frequencies, backgroundColor: '#64748b80', borderColor: '#64748b' }]},
      options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }}, scales: { y: { beginAtZero: true }}}
    });
    (function(){
      const s = monthlyCountsStats;
      const od = s.overdispersion || {};
      const statsEl = document.getElementById('monthlyCountsStats');
      const subtitleEl = document.getElementById('monthlyCountsSubtitle');

      // Calculate and display overdispersion percentage in subtitle
      const mean = od.mean || s.mean;
      const variance = od.variance || s.variance;
      if (mean && variance && mean > 0) {
        const overdispersionPct = ((variance - mean) / mean * 100).toFixed(1);
        if (variance > mean) {
          subtitleEl.textContent = `Overdispersion: +${overdispersionPct}% vs Poisson`;
        } else if (variance < mean) {
          subtitleEl.textContent = `Underdispersion: ${overdispersionPct}% vs Poisson`;
        } else {
          subtitleEl.textContent = `Dispersion: 0% vs Poisson (perfect match)`;
        }
      }

      // Create formatted display with overdispersion analysis
      if (od.overdispersion_param) {
        const phi = od.overdispersion_param;
        const interpretation = od.interpretation || s.model;

        statsEl.innerHTML = `
          <div style="font-weight: 600; margin-bottom: 4px;">
            Overdispersion Analysis: œÜ = ${phi} (${interpretation})
          </div>
          <div style="font-size: 0.85rem;">
            Mean: ${od.mean} ‚Ä¢ Variance: ${od.variance} ‚Ä¢
            ${phi > 1.5 ? `Negative Binomial (n=${od.nb_n}, p=${od.nb_p})` :
              phi < 1.2 ? `Poisson (Œª=${od.poisson_lambda})` :
              'Mixed distribution'}
          </div>
        `;
      } else {
        // Fallback to old format if overdispersion not available
        const lines = [];
        lines.push(`Mean: ${s.mean?.toFixed ? s.mean.toFixed(2) : s.mean}`);
        lines.push(`Variance: ${s.variance?.toFixed ? s.variance.toFixed(2) : s.variance}`);
        if (s.k_estimate) lines.push(`NB dispersion k (est.): ${s.k_estimate.toFixed ? s.k_estimate.toFixed(2) : s.k_estimate}`);
        lines.push(`Model: ${s.model}`);
        statsEl.textContent = lines.join(' ‚Ä¢ ');
      }
    })();

    // 9) OAIC Comparison Chart
    (function(){
      const oaic = oaicComparison;
      if (!oaic.periods || oaic.periods.length === 0) {
        document.getElementById('oaicComparisonChart').parentElement.innerHTML =
          '<div class="chart-title">Database vs OAIC Official Notifications (Half-Yearly)</div>' +
          '<div class="text-center text-muted mt-5"><p>No OAIC data available.<br>Run <code>python oaic_data_scraper.py</code> first.</p></div>';
        return;
      }

      const datasets = [
        {
          label: 'Database Events',
          data: oaic.database_counts,
          borderColor: colors.primary,
          backgroundColor: colors.primary + '20',
          fill: false,
          tension: 0.1,
          pointRadius: 5
        }
      ];

      // Only add OAIC dataset if we have OAIC data
      if (oaic.oaic_available > 0) {
        datasets.push({
          label: 'OAIC Official Notifications',
          data: oaic.oaic_counts,
          borderColor: colors.danger,
          backgroundColor: colors.danger + '20',
          fill: false,
          tension: 0.1,
          pointRadius: 5,
          spanGaps: false  // Don't connect points where data is missing
        });
      }

      // Add pro-rata estimate if available
      if (oaic.prorata_estimate && oaic.prorata_period) {
        // Create array with null values except for the last period
        const prorataData = oaic.periods.map((p, idx) =>
          (p === oaic.prorata_period && idx === oaic.periods.length - 1) ? oaic.prorata_estimate : null
        );

        datasets.push({
          label: 'Estimated Full Period (Pro-rata)',
          data: prorataData,
          borderColor: colors.secondary,
          backgroundColor: colors.secondary,
          fill: false,
          tension: 0,
          pointRadius: 8,
          pointStyle: 'triangle',
          showLine: false  // Don't draw lines between points
        });
      }

      new Chart(document.getElementById('oaicComparisonChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: oaic.periods,
          datasets: datasets
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'top'
            },
            tooltip: {
              callbacks: {
                footer: function(tooltipItems) {
                  const dbCount = tooltipItems.find(item => item.datasetIndex === 0);
                  const oaicCount = tooltipItems.find(item => item.datasetIndex === 1);

                  if (dbCount && oaicCount && oaicCount.raw !== null) {
                    const ratio = (dbCount.raw / oaicCount.raw).toFixed(2);
                    return `Ratio (DB/OAIC): ${ratio}x`;
                  }
                  return '';
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'Number of Events/Notifications'
              }
            },
            x: {
              title: {
                display: true,
                text: 'Half-Year Period'
              }
            }
          }
        }
      });

      // Add summary statistics
      const stats = [];
      stats.push(`Database periods: ${oaic.database_available}`);
      if (oaic.oaic_available > 0) {
        stats.push(`OAIC periods: ${oaic.oaic_available}`);

        // Calculate ratios for overlapping periods
        const ratios = [];
        for (let i = 0; i < oaic.periods.length; i++) {
          const dbCount = oaic.database_counts[i];
          const oaicCount = oaic.oaic_counts[i];
          if (dbCount && oaicCount) {
            ratios.push(dbCount / oaicCount);
          }
        }

        if (ratios.length > 0) {
          const avgRatio = ratios.reduce((a, b) => a + b, 0) / ratios.length;
          stats.push(`Avg ratio (DB/OAIC): ${avgRatio.toFixed(2)}x`);
        }
      } else {
        stats.push('OAIC: No data available');
      }

      // Add pro-rata estimate information if available
      if (oaic.prorata_estimate && oaic.prorata_period) {
        stats.push(`${oaic.prorata_period} (partial): ${oaic.prorata_actual} ‚Üí Est. ${oaic.prorata_estimate}`);
      }

      document.getElementById('oaicComparisonStats').textContent = stats.join(' ‚Ä¢ ');
    })();

    // 10) OAIC Cyber Incidents Chart
    (function(){
      const data = oaicCyberIncidents;
      if (!data.periods || data.periods.length === 0) {
        document.getElementById('oaicCyberIncidentsChart').parentElement.innerHTML =
          '<div class="chart-title">OAIC Cyber Incidents vs Total Notifications</div>' +
          '<div class="text-center text-muted mt-5"><p>No OAIC data available.</p></div>';
        return;
      }

      new Chart(document.getElementById('oaicCyberIncidentsChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: data.periods,
          datasets: [
            {
              label: 'Cyber Incidents',
              data: data.cyber_incidents,
              borderColor: colors.danger,
              backgroundColor: colors.danger + '20',
              fill: true,
              tension: 0.3,
              yAxisID: 'y'
            },
            {
              label: 'Total Notifications',
              data: data.total_notifications,
              borderColor: colors.primary,
              backgroundColor: colors.primary + '20',
              fill: true,
              tension: 0.3,
              yAxisID: 'y1'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false
          },
          scales: {
            y: {
              type: 'linear',
              position: 'left',
              title: {
                display: true,
                text: 'Cyber Incidents'
              }
            },
            y1: {
              type: 'linear',
              position: 'right',
              title: {
                display: true,
                text: 'Total Notifications'
              },
              grid: {
                drawOnChartArea: false
              }
            }
          }
        }
      });
    })();

    // 11) OAIC Attack Types Chart
    (function(){
      const data = oaicAttackTypes;
      if (!data.periods || data.periods.length === 0) {
        document.getElementById('oaicAttackTypesChart').parentElement.innerHTML =
          '<div class="chart-title">OAIC Attack Types Over Time</div>' +
          '<div class="text-center text-muted mt-5"><p>No OAIC data available.</p></div>';
        return;
      }

      const datasets = [];
      const attackColors = {
        'ransomware': '#dc2626',
        'phishing': '#ea580c',
        'hacking': '#ca8a04',
        'malware': '#16a34a',
        'brute_force': '#0891b2',
        'compromised_credentials': '#7c3aed'
      };

      for (const [attackType, values] of Object.entries(data.attack_types)) {
        datasets.push({
          label: attackType.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase()),
          data: values,
          borderColor: attackColors[attackType] || colors.primary,
          backgroundColor: (attackColors[attackType] || colors.primary) + '20',
          fill: false,
          tension: 0.3
        });
      }

      new Chart(document.getElementById('oaicAttackTypesChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: data.periods,
          datasets: datasets
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false
          },
          plugins: {
            legend: {
              position: 'top'
            }
          }
        }
      });
    })();

    // 12) OAIC Top Sectors Chart
    (function(){
      const data = oaicSectors;
      if (!data.sectors || data.sectors.length === 0) {
        document.getElementById('oaicSectorsChart').parentElement.innerHTML =
          '<div class="chart-title">OAIC Top Affected Sectors (2019-2024)</div>' +
          '<div class="text-center text-muted mt-5"><p>No OAIC data available.</p></div>';
        return;
      }

      // Update title based on actual sector count
      const sectorCount = data.sector_count || data.sectors.length;
      document.getElementById('oaicSectorsTitle').textContent =
        `OAIC Top ${sectorCount} Affected Sectors (2019-2024)`;

      new Chart(document.getElementById('oaicSectorsChart').getContext('2d'), {
        type: 'bar',
        data: {
          labels: data.sectors,
          datasets: [
            {
              label: 'OAIC Official Count',
              data: data.oaic_counts,
              backgroundColor: colors.primary,
              borderColor: colors.primary,
              borderWidth: 1
            },
            {
              label: 'Database Count',
              data: data.database_counts,
              backgroundColor: colors.success,
              borderColor: colors.success,
              borderWidth: 1
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          indexAxis: 'y',
          plugins: {
            legend: {
              display: true,
              position: 'top'
            }
          },
          scales: {
            x: {
              title: {
                display: true,
                text: 'Total Notifications (2019-2024)'
              }
            }
          }
        }
      });
    })();

    // 12b) OAIC Sector Ratio Chart (Database/OAIC)
    (function(){
      const data = oaicSectors;
      if (!data.sectors || data.sectors.length === 0 || !data.ratios) {
        document.getElementById('oaicSectorRatioChart').parentElement.innerHTML =
          '<div class="chart-title">Database/OAIC Ratio by Sector</div>' +
          '<div class="text-center text-muted mt-5"><p>No ratio data available.</p></div>';
        return;
      }

      // Convert ratios to percentages and color bars (green if >= 100%, orange if < 100%)
      const ratiosPct = data.ratios.map(r => Math.round(r * 100));
      const barColors = ratiosPct.map(r => r >= 100 ? colors.success : colors.warning);

      new Chart(document.getElementById('oaicSectorRatioChart').getContext('2d'), {
        type: 'bar',
        data: {
          labels: data.sectors,
          datasets: [
            {
              label: 'Database/OAIC %',
              data: ratiosPct,
              backgroundColor: barColors,
              borderColor: barColors,
              borderWidth: 1
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          indexAxis: 'y',
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  const pct = context.raw;
                  const idx = context.dataIndex;
                  const dbCount = data.database_counts[idx];
                  const oaicCount = data.oaic_counts[idx];
                  return [
                    `Coverage: ${pct}%`,
                    `Database: ${dbCount}`,
                    `OAIC: ${oaicCount}`
                  ];
                }
              }
            },
            annotation: {
              annotations: {
                line1: {
                  type: 'line',
                  xMin: 100,
                  xMax: 100,
                  borderColor: '#ef4444',
                  borderWidth: 2,
                  borderDash: [5, 5],
                  label: {
                    display: true,
                    content: '100%',
                    position: 'end'
                  }
                }
              }
            }
          },
          scales: {
            x: {
              title: {
                display: true,
                text: 'Database Coverage of OAIC Count (%)'
              },
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return value + '%';
                }
              }
            }
          }
        }
      });
    })();

    // 13) OAIC Individuals Affected Chart
    (function(){
      const data = oaicIndividualsAffected;
      if (!data.periods || data.periods.length === 0) {
        document.getElementById('oaicIndividualsAffectedChart').parentElement.innerHTML =
          '<div class="chart-title">OAIC Individuals Affected Trends</div>' +
          '<div class="text-center text-muted mt-5"><p>No OAIC data available.</p></div>';
        return;
      }

      new Chart(document.getElementById('oaicIndividualsAffectedChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: data.periods,
          datasets: [
            {
              label: 'OAIC Average Individuals Affected',
              data: data.averages,
              borderColor: colors.danger,
              backgroundColor: colors.danger + '20',
              fill: true,
              tension: 0.3
            },
            {
              label: 'OAIC Median Individuals Affected',
              data: data.medians,
              borderColor: colors.primary,
              backgroundColor: colors.primary + '20',
              fill: true,
              tension: 0.3
            },
            {
              label: 'Database Average Records Affected',
              data: data.db_averages,
              borderColor: colors.success,
              backgroundColor: colors.success + '20',
              fill: true,
              tension: 0.3
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false
          },
          plugins: {
            legend: {
              position: 'top'
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  let label = context.dataset.label || '';
                  if (label) {
                    label += ': ';
                  }
                  if (context.parsed.y !== null) {
                    label += new Intl.NumberFormat('en-US').format(context.parsed.y);
                  }
                  return label;
                }
              }
            }
          },
          scales: {
            y: {
              type: 'logarithmic',
              title: {
                display: true,
                text: 'Number of Individuals (log scale)'
              },
              ticks: {
                callback: function(value) {
                  return new Intl.NumberFormat('en-US', { notation: 'compact' }).format(value);
                }
              }
            }
          }
        }
      });
    })();

    // 14) Event Type Correlation Matrix
    (function(){
      const corr = eventTypeCorrelation;
      if (!corr.labels || corr.labels.length === 0) {
        document.getElementById('correlationMatrixChart').parentElement.innerHTML =
          '<div class="chart-title">Event Type Correlation Matrix (Monthly Counts)</div>' +
          '<div class="text-center text-muted mt-5"><p>Insufficient data for correlation analysis.<br>Need at least 2 event types with 5+ months of data.</p></div>';
        return;
      }

      const labels = corr.labels;
      const matrix = corr.correlation_matrix;
      
      // Create a custom heatmap using HTML table since Chart.js doesn't have a native heatmap
      const canvas = document.getElementById('correlationMatrixChart');
      const ctx = canvas.getContext('2d');
      const container = canvas.parentElement;
      
      // Create table-based heatmap
      const table = document.createElement('table');
      table.style.width = '100%';
      table.style.height = '100%';
      table.style.borderCollapse = 'collapse';
      table.style.fontSize = '12px';
      table.style.tableLayout = 'fixed';
      
      // Create header row
      const headerRow = document.createElement('tr');
      const emptyCell = document.createElement('th');
      emptyCell.style.border = '1px solid #ddd';
      emptyCell.style.padding = '8px';
      emptyCell.style.backgroundColor = '#f8f9fa';
      headerRow.appendChild(emptyCell);
      
      labels.forEach(label => {
        const th = document.createElement('th');
        th.textContent = label;
        th.style.border = '1px solid #ddd';
        th.style.padding = '6px 8px';
        th.style.backgroundColor = '#f8f9fa';
        th.style.fontSize = '11px';
        th.style.textAlign = 'center';
        th.style.whiteSpace = 'normal';
        th.style.wordBreak = 'break-word';
        th.style.lineHeight = '1.2';
        headerRow.appendChild(th);
      });
      table.appendChild(headerRow);
      
      // Create data rows
      labels.forEach((label, i) => {
        const row = document.createElement('tr');
        
        // Row label
        const rowLabel = document.createElement('td');
        rowLabel.textContent = label;
        rowLabel.style.border = '1px solid #ddd';
        rowLabel.style.padding = '8px';
        rowLabel.style.backgroundColor = '#f8f9fa';
        rowLabel.style.fontSize = '11px';
        rowLabel.style.fontWeight = 'bold';
        row.appendChild(rowLabel);
        
        // Data cells
        labels.forEach((_, j) => {
          const cell = document.createElement('td');
          const value = matrix[i][j];
          cell.textContent = value.toFixed(3);
          cell.style.border = '1px solid #ddd';
          cell.style.padding = '8px';
          cell.style.textAlign = 'center';
          cell.style.fontSize = '11px';
          cell.style.fontWeight = 'bold';
          
          // Color coding
          if (value < 0) {
            const intensity = Math.abs(value);
            const alpha = 0.3 + intensity * 0.7;
            cell.style.backgroundColor = `rgba(239, 68, 68, ${alpha})`;
            cell.style.color = intensity > 0.5 ? 'white' : 'black';
          } else if (value > 0) {
            const intensity = value;
            const alpha = 0.3 + intensity * 0.7;
            cell.style.backgroundColor = `rgba(59, 130, 246, ${alpha})`;
            cell.style.color = intensity > 0.5 ? 'white' : 'black';
          } else {
            cell.style.backgroundColor = 'rgba(156, 163, 175, 0.3)';
            cell.style.color = 'black';
          }
          
          // Tooltip
          cell.title = `${labels[i]} vs ${labels[j]}: ${value.toFixed(3)}`;
          row.appendChild(cell);
        });
        
        table.appendChild(row);
      });
      
      // Replace canvas with table
      container.replaceChild(table, canvas);
      
      // Add correlation statistics
      const stats = [];
      stats.push(`Event types: ${labels.length}`);
      stats.push(`Min correlation: ${corr.min_correlation.toFixed(3)}`);
      stats.push(`Max correlation: ${corr.max_correlation.toFixed(3)}`);
      
      // Find strongest positive and negative correlations
      let maxPos = -1, maxNeg = 1;
      let maxPosPair = '', maxNegPair = '';
      
      for (let i = 0; i < labels.length; i++) {
        for (let j = i + 1; j < labels.length; j++) {
          const corrValue = matrix[i][j];
          if (corrValue > maxPos) {
            maxPos = corrValue;
            maxPosPair = `${labels[i]} & ${labels[j]}`;
          }
          if (corrValue < maxNeg) {
            maxNeg = corrValue;
            maxNegPair = `${labels[i]} & ${labels[j]}`;
          }
        }
      }
      
      if (maxPosPair) stats.push(`Strongest positive: ${maxPosPair} (${maxPos.toFixed(3)})`);
      if (maxNegPair) stats.push(`Strongest negative: ${maxNegPair} (${maxNeg.toFixed(3)})`);

      document.getElementById('correlationMatrixStats').textContent = stats.join(' ‚Ä¢ ');
    })();

    // Maximum Severity Per Month Chart
    (() => {
      const maxSeverityData = {"months": ["2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06", "2025-07", "2025-08", "2025-09", "2025-10", "2025-11"], "severities": ["EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL"], "titles": ["Toll Group Ransomware Attack and Data Leak", "Controversial facial recognition startup Clearview AI hit by massive client data breach", "Federal court data breach sees names of protection visa applicants made public", "Australian University Event Registration System Data Breach", "Exclusive: 70 million records exposed in data leak from AFL fan website, cyber researchers claim", "Lion Dairy & Drinks Ransomware Attack", "Garmin goes down after suspected ransomware attack", "NSW driver's licence data breach left Sydney health worker 'sickened'", "Booking.com, Expedia Group, Hotels.com customers in suspected data breach", "Gravatar profile add-on leaks data on millions of users", "Ransomware Attack on B&R Enclosures", "TfNSW hit by another data breach", "Leaked Employee Credentials from Australia's Big Four Banks Found on Dark Web", "Cyber attacks on rise as criminals target Australian agricultural ...", "China suspected of cyber attack on Western Australia's Parliament ...", "South Australian Government Payroll Data Breach via Frontier Software Ransomware Attack", "BLK Sport DarkSide Ransomware Attack", "NSW Health admits personal data accessed in Accellion breach", "SonicWall devices at risk of ransomware, ACSC rings alarm bells ...", "The Good Guys customers possibly affected by data breach at former third-party provider My Rewards", "Cybersecurity experts weigh in on GoDaddy data breach", "Twitch hack reveals multi-million-dollar sums top streamers earn from playing computer games", "Refer compo spreadsheet data breach to privacy watchdog: ACT firies' union", "How the SA Government Data Breach was avoidable | InConsult", "Vinomofo did not protect personal information from security risks, Privacy Commissioner finds", "Medlab Pathology Ransomware/Data Breach Incident", "Toyota suspends domestic factory operations after suspected cyber attack", "Australian Healthcare Sector Targeted by Ransomware and Remote Access Tool Attacks", "Leak of Nauru Police Force Files Related to Australian Offshore Processing", "Royal Flying Doctors Service's Rapid Ransomware Recovery ...", "Woolworths MyDeal Data Breach", "Australia Blames Russian Hacker for Major Cyber Attack - The ...", "AFP officer data leaked in cyber breach", "Cyber attack cripples Fire Rescue Victoria", "Privacy | NSW Health Pathology", "Data breach hits Victoria\u2019s revenue office", "Cyber Incident at Western Sydney University", "Pound Road Medical Center Ransomware Attack", "Latitude Financial cyber-attack worse than first thought with 14m ...", "HWL Ebsworth Cyber Security Incident", "FIIG Securities Cybersecurity Breach", "Dymocks warns customers of data breach after account information leaked on dark web", "Pizza Hut Australia Data Breach", "TissuPath data breach victim upset by delayed notification", "Defence Housing Australia Third-Party Provider Data Breach", "Charity donor details\u2026 - Institute of Community Directors Australia", "MediSecure Ransomware Attack and Massive Health Data Breach", "Nissan's Australian and New Zealand operations hit by cyber attack ...", "Print music giant Hal Leonard Australia falls victim to Qilin ransomware", "Untitled Event", "Raft of Australian companies compromised in hosting service hack", "Huge trove of Australian client data leaked following OracleCMS call centre hack", "BianLian Ransomware Attack on Insula Group", "Exclusive: Victorian IT services company Insula confirms BianLian ransomware attack", "Exclusive: Aussie engineering firm confirms RansomHub ransomware attack", "F5 Cybersecurity Breach Sparks National Security Concerns", "Internet Archive down, claims \u2018catastrophic\u2019 data breach impacting 31m", "New Ransomware Group Sarcoma Targets Australian Companies ...", "Australian Fluid Power Ransomware Attack", "Exclusive: Qilin ransomware operation claims hack of Aussie freight forwarder", "ARDEX Australia Medusa Ransomware Attack", "Cyber Warfare - 9News - Latest news and headlines from Australia ...", "DaVita Inc. Healthcare Data Breach", "AUD 500,000 Lost in Cyber Attack on Australian Superannuation ...", "Legal Practice Board cyber attack updates | Law Society of Western ...", "Dragonforce Group Data Leak at Australian Engineering Firm", "Mercer Super reports security breach after Australia Post Melbourne ...", "Exclusive: Victoria\u2019s Loyola College confirms cyber incident", "Asahi Ransomware Attack", "Scattered Spider Ransomware Attacks Target Australian Healthcare Sector", "INC Ransom ransomware attack on Facade Innovations"], "entities": ["Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity"], "severity_numeric": [4, 3, 4, 3, 3, 4, 4, 3, 4, 3, 4, 3, 3, 4, 3, 3, 3, 3, 3, 3, 3, 4, 3, 4, 3, 4, 3, 4, 3, 3, 3, 4, 3, 4, 3, 3, 3, 4, 3, 4, 4, 3, 3, 3, 3, 3, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 4, 3, 4, 4, 3, 4, 3, 4, 4, 4, 4], "avg_severity_numeric": [3.22, 3.0, 3.11, 3.0, 2.12, 2.37, 3.0, 2.56, 2.71, 2.0, 3.33, 2.75, 2.94, 2.67, 2.88, 2.4, 3.0, 2.75, 2.14, 3.0, 3.0, 2.6, 2.64, 2.62, 2.75, 2.5, 2.75, 3.0, 2.75, 2.0, 2.89, 2.73, 2.29, 2.33, 2.0, 2.62, 2.36, 2.33, 2.18, 2.75, 2.7, 2.58, 1.6, 2.67, 2.67, 2.4, 2.62, 2.48, 2.86, 2.75, 2.5, 3.04, 2.61, 2.55, 2.9, 2.71, 2.53, 2.13, 2.1, 2.64, 2.52, 2.0, 2.22, 2.4, 2.0, 2.41, 2.3, 2.45, 2.67, 2.23, 4.0]};
      new Chart(document.getElementById('maxSeverityChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: maxSeverityData.months,
          datasets: [{
            label: 'Maximum Severity',
            data: maxSeverityData.severity_numeric,
            borderColor: '#dc2626',
            backgroundColor: '#dc262620',
            fill: false,
            tension: 0.4,
            pointRadius: 6,
            pointHoverRadius: 8,
            borderWidth: 3
          }, {
            label: 'Average Severity',
            data: maxSeverityData.avg_severity_numeric,
            borderColor: '#f59e0b',
            backgroundColor: '#f59e0b20',
            fill: false,
            tension: 0.4,
            pointRadius: 4,
            pointHoverRadius: 6,
            borderWidth: 2,
            borderDash: [5, 5]
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: true, position: 'top' },
            tooltip: {
              callbacks: {
                title: function(tooltipItems) {
                  const index = tooltipItems[0].dataIndex;
                  return maxSeverityData.months[index];
                },
                label: function(tooltipItem) {
                  const index = tooltipItem.dataIndex;
                  const datasetLabel = tooltipItem.dataset.label;
                  if (datasetLabel === 'Maximum Severity') {
                    return `Maximum: ${maxSeverityData.severities[index]}`;
                  } else {
                    const avgValue = maxSeverityData.avg_severity_numeric[index];
                    const severityLabels = ['Unknown', 'Low', 'Medium', 'High', 'Critical'];
                    const nearestLabel = severityLabels[Math.round(avgValue)] || 'Unknown';
                    return `Average: ${nearestLabel} (${avgValue.toFixed(2)})`;
                  }
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              max: 4,
              ticks: {
                callback: function(value) {
                  const severityMap = {0: 'Unknown', 1: 'Low', 2: 'Medium', 3: 'High', 4: 'Critical'};
                  return severityMap[value] || value;
                }
              },
              title: { display: true, text: 'Severity Level' }
            },
            x: { title: { display: true, text: 'Month' } }
          }
        }
      });
    })();

    // 12) Maximum Records Affected Per Month
    (function() {
      const maxRecordsData = maxRecordsPerMonth;
      new Chart(document.getElementById('maxRecordsChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: maxRecordsData.months,
          datasets: [{
            label: 'Maximum Records Affected',
            data: maxRecordsData.max_records,
            borderColor: '#dc2626',
            backgroundColor: '#dc262620',
            fill: false,
            tension: 0.4,
            pointRadius: 6,
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                title: function(tooltipItems) {
                  const index = tooltipItems[0].dataIndex;
                  return maxRecordsData.titles[index] || 'Unknown Event';
                },
                label: function(tooltipItem) {
                  const index = tooltipItem.dataIndex;
                  const records = maxRecordsData.max_records[index];
                  return [
                    `Entity: ${maxRecordsData.entities[index]}`,
                    `Records: ${records.toLocaleString()}`
                  ];
                }
              }
            }
          },
          scales: {
            y: {
              type: 'logarithmic',
              beginAtZero: true,
              title: { display: true, text: 'Records Affected (log scale)' }
            },
            x: {
              title: { display: true, text: 'Month' }
            }
          }
        }
      });
    })();

    // Severity by Industry Radar Chart
    (() => {
      const severityByIndustry = {"industries": ["Technology", "Healthcare", "Others", "Government & Defense", "Financial Services", "Education", "Transportation", "Infrastructure", "Professional Services", "Telecommunications", "Not for Profit"], "avg_severities": [2.659340659340659, 2.6707317073170733, 2.290909090909091, 2.372549019607843, 2.782608695652174, 2.7142857142857144, 2.4, 2.230769230769231, 1.8461538461538463, 2.5, 2.75], "no_data": false};

      // Check if there's no data (all Unknown industries)
      if (severityByIndustry.no_data || !severityByIndustry.industries || severityByIndustry.industries.length === 0) {
        const container = document.getElementById('severityByIndustryChart').parentElement;
        container.innerHTML =
          '<div class="chart-title">Average Severity by Industry</div>' +
          '<div class="text-center text-muted mt-5">' +
          '<p>No industry data available.</p>' +
          '<p style="font-size: 0.9rem;">The enrichment process has not yet populated industry information for events.</p>' +
          '</div>';
        return;
      }

      new Chart(document.getElementById('severityByIndustryChart').getContext('2d'), {
        type: 'radar',
        data: {
          labels: severityByIndustry.industries,
          datasets: [{
            label: 'Average Severity',
            data: severityByIndustry.avg_severities,
            backgroundColor: '#2563eb20',
            borderColor: '#2563eb',
            borderWidth: 2,
            pointBackgroundColor: '#2563eb',
            pointBorderColor: '#2563eb'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: {
            r: {
              beginAtZero: true,
              max: 4,
              ticks: {
                callback: function(value) {
                  const severityMap = {0: 'Unknown', 1: 'Low', 2: 'Medium', 3: 'High', 4: 'Critical'};
                  return severityMap[value] || value;
                }
              }
            }
          }
        }
      });
    })();

    // Severity by Attack Type Radar Chart
    (() => {
      const severityByAttackType = {"attack_types": ["Data Breach", "Denial Of Service", "Financial Fraud", "Infrastructure Attack", "Malware", "Other", "Phishing", "Ransomware", "State Sponsored Attack", "Supply Chain Attack", "Vulnerability Exploit"], "avg_severities": [2.7989821882951653, 2.8, 3.3333333333333335, 3.0, 2.5, 0.5370370370370371, 2.375, 3.0476190476190474, 3.111111111111111, 3.0, 3.0]};
      new Chart(document.getElementById('severityByAttackTypeChart').getContext('2d'), {
        type: 'radar',
        data: {
          labels: severityByAttackType.attack_types,
          datasets: [{
            label: 'Average Severity',
            data: severityByAttackType.avg_severities,
            backgroundColor: '#05966920',
            borderColor: '#059669',
            borderWidth: 2,
            pointBackgroundColor: '#059669',
            pointBorderColor: '#059669'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: {
            r: {
              beginAtZero: true,
              max: 4,
              ticks: {
                callback: function(value) {
                  const severityMap = {0: 'Unknown', 1: 'Low', 2: 'Medium', 3: 'High', 4: 'Critical'};
                  return severityMap[value] || value;
                }
              }
            }
          }
        }
      });
    })();

    // 13) Average Records Affected by Attack Type
    (function() {
      const recordsData = recordsByAttackType;
      new Chart(document.getElementById('recordsByAttackTypeChart').getContext('2d'), {
        type: 'bar',
        data: {
          labels: recordsData.attack_types,
          datasets: [{
            label: 'Average Records Affected',
            data: recordsData.avg_records,
            backgroundColor: '#7c3aed',
            borderColor: '#7c3aed',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          indexAxis: 'y',
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: function(tooltipItem) {
                  const value = tooltipItem.raw;
                  return `Average: ${value.toLocaleString(undefined, {maximumFractionDigits: 0})} records`;
                }
              }
            }
          },
          scales: {
            x: {
              type: 'logarithmic',
              beginAtZero: true,
              title: { display: true, text: 'Average Records Affected (log scale)' },
              ticks: {
                callback: function(value) {
                  return value.toLocaleString();
                }
              }
            },
            y: {
              title: { display: true, text: 'Attack Type' }
            }
          }
        }
      });
    })();
  </script>
</body>
</html>
