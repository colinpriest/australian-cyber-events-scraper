<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Australian Cyber Security Events Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><text y='14' font-size='14'>üõ°Ô∏è</text></svg>" />
  <style>
    body { background-color: #f8f9fa; }
    .dashboard-header { background: linear-gradient(135deg, #2563eb, #1e40af); color: white; padding: 2rem 0; margin-bottom: 2rem; }
    .chart-container { background: white; border-radius: 12px; padding: 1.25rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 2rem; height: 380px; }
    .chart-title { font-size: 1.1rem; font-weight: 600; color: #374151; margin-bottom: 1rem; text-align: center; }
    .last-updated { color: #e5e7eb; font-size: 0.9rem; }
    .risk-matrix table { font-size: 0.9rem; }
    .risk-matrix .impact-label { width: 260px; text-align: left; font-weight: 600; }
    .risk-matrix .group-header { white-space: normal; }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
</head>
<body>
  <div class="dashboard-header">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-8">
          <h1 class="mb-0">Australian Cyber Security Events Dashboard</h1>
          <p class="mb-0 last-updated">Date Range: 2020-01-01 to 2026-01-16</p>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="row">
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Monthly Trends in Unique Event Count</div>
          <canvas id="monthlyTrendsChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Monthly Trends in Severity</div>
          <canvas id="severityTrendsChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Monthly Trends in Average Records Affected</div>
          <canvas id="recordsAffectedChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Monthly Trends in Event Type Mix</div>
          <canvas id="eventTypeMixChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Overall Mix of Entity Types</div>
          <canvas id="entityTypeChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Overall Event Type Mix (Pie)</div>
          <canvas id="overallEventTypePieChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Records Affected Histogram</div>
          <canvas id="recordsHistogramChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Severity per Month</div>
          <canvas id="maxSeverityChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Maximum Records Affected Per Month</div>
          <canvas id="maxRecordsChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Average Severity by Industry</div>
          <canvas id="severityByIndustryChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Average Severity by Attack Type</div>
          <canvas id="severityByAttackTypeChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Average Records Affected by Attack Type</div>
          <canvas id="recordsByAttackTypeChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container" style="height: 440px; overflow: hidden;">
          <div class="chart-title">Histogram of Monthly Unique Event Counts</div>
          <div id="monthlyCountsSubtitle" class="chart-subtitle" style="font-size: 0.95rem; color: #6b7280; margin-top: -8px; margin-bottom: 8px;"></div>
          <div style="height: 300px; position: relative;">
            <canvas id="monthlyCountsHistChart"></canvas>
          </div>
          <div id="monthlyCountsStats" class="mt-2" style="font-size: 0.9rem; color: #374151;"></div>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Database vs OAIC Official Notifications (Half-Yearly)</div>
          <canvas id="oaicComparisonChart"></canvas>
          <div id="oaicComparisonStats" class="mt-2" style="font-size: 0.9rem; color: #374151;"></div>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">OAIC Cyber Incidents vs Total Notifications</div>
          <canvas id="oaicCyberIncidentsChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">OAIC Attack Types Over Time</div>
          <canvas id="oaicAttackTypesChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title" id="oaicSectorsTitle">OAIC Top Affected Sectors (2020-2025)</div>
          <canvas id="oaicSectorsChart"></canvas>
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="chart-container">
          <div class="chart-title">Database/OAIC Ratio by Sector</div>
          <canvas id="oaicSectorRatioChart"></canvas>
        </div>
      </div>
      <div class="col-lg-12 col-md-12">
        <div class="chart-container">
          <div class="chart-title">OAIC Individuals Affected Trends</div>
          <canvas id="oaicIndividualsAffectedChart"></canvas>
        </div>
      </div>
      <div class="col-lg-12 col-md-12">
        <div class="chart-container risk-matrix" style="height: auto;">
          <div class="chart-title d-flex justify-content-between align-items-center">
            <span>ASD Risk Matrix (All Years)</span>
            <span class="badge bg-secondary">Classifications: <span id="asdAllTotal">0</span></span>
          </div>
          <div id="asdRiskMatrixAll"></div>
        </div>
      </div>
      <div class="col-lg-12 col-md-12">
        <div class="chart-container risk-matrix" style="height: auto;">
          <div class="chart-title d-flex justify-content-between align-items-center">
            <span>ASD Risk Matrix (Current Year)</span>
            <span class="badge bg-secondary">Classifications: <span id="asdCurrentTotal">0</span></span>
          </div>
          <div id="asdRiskMatrixCurrent"></div>
        </div>
      </div>
      <div class="col-lg-12 col-md-12">
        <div class="chart-container risk-matrix" style="height: auto;">
          <div class="chart-title d-flex justify-content-between align-items-center">
            <span>ASD Risk Matrix (Previous Year)</span>
            <span class="badge bg-secondary">Classifications: <span id="asdPreviousTotal">0</span></span>
          </div>
          <div id="asdRiskMatrixPrevious"></div>
        </div>
      </div>
      <div class="col-lg-12 col-md-12">
        <div class="chart-container" style="height: 500px;">
          <div class="chart-title">Event Type Correlation Matrix (Monthly Counts)</div>
          <canvas id="correlationMatrixChart"></canvas>
          <div id="correlationMatrixStats" class="mt-2" style="font-size: 0.9rem; color: #374151;"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Embedded data (static)
    const monthlyCounts = {"months": ["2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06", "2025-07", "2025-08", "2025-09", "2025-10", "2025-11", "2025-12", "2026-01"], "counts": [10, 9, 9, 1, 8, 20, 8, 7, 7, 3, 7, 7, 19, 10, 6, 5, 2, 3, 6, 3, 1, 4, 13, 6, 4, 11, 4, 3, 8, 3, 6, 15, 16, 12, 9, 8, 11, 3, 14, 15, 10, 10, 6, 7, 10, 4, 28, 22, 13, 11, 10, 26, 21, 12, 16, 9, 18, 14, 12, 9, 31, 16, 22, 17, 9, 20, 7, 23, 9, 26, 8, 2, 6], "total_events": 780, "avg_per_month": 10.684931506849315, "overdispersion": {"mean": 10.68, "variance": 46.77, "overdispersion_param": 4.378, "poisson_lambda": 10.68, "nb_n": 3.16, "nb_p": 0.228, "interpretation": "Negative Binomial"}};
    const severityTrends = {"months": ["2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06", "2025-07", "2025-08", "2025-09", "2025-10", "2025-11", "2025-12", "2026-01"], "data": {"Critical": [2, 0, 2, 0, 0, 1, 1, 1, 2, 0, 2, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 2, 0, 0, 0, 0, 0, 2, 0, 2, 0, 0, 1, 1, 0, 2, 1, 0, 0, 0, 0, 0, 2, 1, 1, 0, 1, 5, 0, 1, 3, 1, 1, 0, 2, 1, 3, 1, 0, 3, 1, 4, 0, 0, 1, 0, 1, 0, 3], "High": [8, 8, 6, 1, 5, 14, 6, 5, 4, 2, 4, 5, 16, 7, 5, 4, 2, 2, 4, 3, 1, 2, 9, 4, 3, 7, 2, 2, 6, 2, 5, 11, 11, 6, 6, 7, 8, 1, 8, 8, 7, 8, 4, 6, 9, 2, 19, 15, 12, 11, 6, 17, 16, 8, 11, 8, 14, 9, 7, 8, 22, 10, 16, 10, 4, 10, 5, 18, 5, 17, 5, 2, 3], "Medium": [0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 2, 3, 2, 0, 0, 0, 1, 0, 0, 0, 0, 2, 1, 1, 0, 1, 1, 2, 0, 1, 0, 1, 1, 0, 0, 0, 0, 2, 2, 1, 1, 1, 0, 0, 2, 2, 3, 0, 0, 1, 2, 1, 2, 1, 0, 0, 0, 0, 0, 3, 0, 0, 0, 1, 2, 0, 0, 0, 2, 0, 0, 0], "Unknown": [0, 0, 0, 0, 2, 4, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 2, 0, 0, 1, 2, 0, 0, 1, 1, 0, 0, 1, 0, 2, 4, 3, 3, 1, 2, 1, 4, 3, 1, 1, 1, 1, 1, 0, 5, 3, 0, 0, 2, 2, 4, 1, 1, 0, 3, 5, 3, 0, 3, 5, 6, 4, 3, 4, 2, 5, 1, 7, 2, 0, 0], "Low": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}};
    const recordsAffected = {"months": ["2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06", "2025-07", "2025-08", "2025-09", "2025-10", "2025-11", "2025-12", "2026-01"], "averages": [1908782.857142857, 10006.666666666666, 1129666.6666666667, 8800.0, 181406.66666666666, 14224061.166666666, 12933816.0, 2139200.0, 22390078.25, 114000000.0, 500.0, 65750.0, 1114546.6666666667, 1704916.6666666667, 31500.0, 45602.666666666664, 350037000.0, 1500.0, 1244333.3333333333, 1200000.0, 5015750.0, 875844.4545454546, 2744044.8, 416781.5, 250700.0, 187611.33333333334, 500.0, 108146.2, 193000.0, 3556253.3333333335, 7244615.384615385, 5331519.923076923, 3509333.3333333335, 1902376.0, 27593.666666666668, 3019286.4444444445, 328000.0, 10210181.818181818, 1233210.0, 570029.0, 1085625.0, 57000.0, 132500.0, 309833.3333333333, 19230.666666666668, 3642761.6666666665, 65285.71428571428, 8754000.0, 389413.3333333333, 9950100.0, 36949213.2631579, 9082659.57142857, 303121.1666666667, 2803915.6666666665, 77649.0, 25920072.85714286, 4600770.857142857, 549100.0, 144037.66666666666, 421261.9, 71554.4, 427625.9285714286, 873514.2857142857, 8094.0, 9006089.846153846, 137000.0, 225062.0, 1447155.75, 50916.09090909091, 158460.0, 38500.0, 268000.0], "medians": [100000.0, 10000.0, 186000.0, 8800.0, 100000.0, 15950000.0, 950.0, 444000.0, 6200000.0, 114000000.0, 500.0, 65750.0, 31000.0, 9750.0, 31500.0, 46980.0, 350037000.0, 1500.0, 1850000.0, 1200000.0, 5015750.0, 80000.0, 80000.0, 369000.0, 223000.0, 13000.0, 500.0, 50000.0, 193000.0, 928760.0, 9700000.0, 5700000.0, 80000.0, 6000.0, 8927.5, 16000.0, 328000.0, 14000000.0, 1125000.0, 18000.0, 1240000.0, 12500.0, 161500.0, 193000.0, 7500.0, 71302.5, 100000.0, 792000.0, 355384.0, 12900000.0, 12900000.0, 9606886.5, 59239.5, 1100000.0, 5750.0, 74373.0, 296124.0, 800000.0, 29843.0, 144917.0, 9000.0, 20000.0, 20000.0, 8094.0, 5700000.0, 84000.0, 142500.0, 39661.5, 26005.0, 27000.0, 38500.0, 268000.0], "confidence_intervals": [[1527026.2857142857, 2290539.4285714286], [8005.333333333333, 12008.0], [903733.3333333334, 1355600.0], [7040.0, 10560.0], [145125.3333333333, 217688.0], [11379248.933333334, 17068873.4], [10347052.8, 15520579.2], [1711360.0, 2567040.0], [17912062.6, 26868093.9], [91200000.0, 136800000.0], [400.0, 600.0], [52600.0, 78900.0], [891637.3333333334, 1337456.0], [1363933.3333333335, 2045900.0], [25200.0, 37800.0], [36482.13333333333, 54723.2], [280029600.0, 420044400.0], [1200.0, 1800.0], [995466.6666666666, 1493200.0], [960000.0, 1440000.0], [4012600.0, 6018900.0], [700675.5636363637, 1051013.3454545455], [2195235.84, 3292853.76], [333425.2, 500137.8], [200560.0, 300840.0], [150089.06666666668, 225133.6], [400.0, 600.0], [86516.95999999999, 129775.44], [154400.0, 231600.0], [2845002.666666667, 4267504.0], [5795692.307692308, 8693538.461538462], [4265215.938461538, 6397823.907692308], [2807466.666666667, 4211200.0], [1521900.8, 2282851.2], [22074.933333333334, 33112.4], [2415429.1555555556, 3623143.7333333334], [262400.0, 393600.0], [8168145.454545455, 12252218.181818182], [986568.0, 1479852.0], [456023.2, 684034.8], [868500.0, 1302750.0], [45600.0, 68400.0], [106000.0, 159000.0], [247866.66666666666, 371800.0], [15384.533333333335, 23076.800000000003], [2914209.333333333, 4371314.0], [52228.57142857143, 78342.85714285714], [7003200.0, 10504800.0], [311530.6666666666, 467296.0], [7960080.0, 11940120.0], [29559370.610526316, 44339055.91578948], [7266127.657142857, 10899191.485714285], [242496.93333333335, 363745.4], [2243132.533333333, 3364698.8], [62119.2, 93178.8], [20736058.285714287, 31104087.42857143], [3680616.685714286, 5520925.028571429], [439280.0, 658920.0], [115230.13333333333, 172845.19999999998], [337009.52, 505514.28], [57243.52, 85865.28], [342100.7428571429, 513151.1142857143], [698811.4285714285, 1048217.1428571428], [6475.2, 9712.8], [7204871.876923077, 10807307.815384615], [109600.0, 164400.0], [180049.6, 270074.4], [1157724.6, 1736586.9], [40732.87272727273, 61099.3090909091], [126768.0, 190152.0], [30800.0, 46200.0], [214400.0, 321600.0]], "sample_sizes": [7, 3, 6, 1, 3, 6, 6, 5, 4, 1, 1, 2, 15, 6, 1, 3, 2, 1, 3, 1, 2, 11, 5, 4, 10, 3, 1, 5, 1, 3, 13, 13, 9, 3, 6, 9, 1, 11, 10, 5, 8, 4, 4, 6, 3, 18, 7, 3, 3, 4, 19, 14, 6, 6, 4, 7, 7, 3, 3, 10, 5, 14, 7, 1, 13, 4, 10, 4, 11, 5, 2, 2]};
    const eventTypeMix = {"months": ["2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06", "2025-07", "2025-08", "2025-09", "2025-10", "2025-11", "2025-12", "2026-01"], "types": {"Data Breach": [6, 5, 5, 1, 3, 7, 7, 4, 4, 1, 3, 6, 8, 5, 0, 1, 1, 3, 2, 2, 1, 3, 7, 4, 4, 6, 2, 2, 4, 1, 6, 12, 12, 5, 6, 6, 9, 1, 7, 10, 8, 9, 5, 5, 6, 2, 14, 9, 8, 6, 3, 16, 17, 3, 6, 2, 6, 6, 4, 2, 11, 4, 11, 5, 1, 10, 1, 8, 0, 10, 3, 0, 5], "Ransomware": [4, 3, 3, 0, 2, 5, 1, 2, 0, 1, 3, 0, 0, 3, 1, 3, 1, 0, 1, 1, 0, 0, 4, 2, 0, 3, 0, 0, 3, 1, 0, 2, 0, 2, 0, 0, 0, 1, 1, 3, 1, 0, 0, 2, 3, 1, 3, 6, 4, 4, 3, 7, 1, 9, 7, 4, 10, 2, 6, 6, 14, 5, 4, 8, 4, 6, 2, 7, 6, 7, 2, 2, 1], "Other": [0, 1, 0, 0, 2, 2, 0, 1, 0, 1, 1, 0, 2, 1, 3, 1, 0, 0, 2, 0, 0, 1, 2, 0, 0, 1, 1, 1, 0, 1, 0, 0, 4, 3, 2, 2, 2, 1, 4, 2, 1, 1, 0, 0, 1, 0, 6, 4, 0, 0, 1, 2, 2, 0, 2, 2, 2, 5, 0, 0, 4, 5, 5, 3, 4, 4, 2, 6, 1, 6, 2, 0, 0], "Phishing": [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 1, 0, 0, 0], "State Sponsored Attack": [0, 0, 0, 0, 1, 3, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0], "Infrastructure Attack": [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 3, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "Malware": [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "Vulnerability Exploit": [0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0], "Financial Fraud": [0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "Denial Of Service": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "Supply Chain Attack": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 2, 0, 0, 0], "Identity Theft": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "Unknown": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0]}};
    const overallEventTypeMix = {"labels": ["Data Breach", "Ransomware", "Other", "State Sponsored Attack", "Infrastructure Attack", "Malware", "Vulnerability Exploit", "Phishing", "Denial Of Service", "Supply Chain Attack", "Financial Fraud", "Unknown", "Identity Theft"], "counts": [388, 203, 115, 18, 13, 11, 9, 8, 5, 4, 3, 2, 1]};
    const entityTypes = {"types": [{"type": "Technology", "events": 151, "entities": 151}, {"type": "Healthcare", "events": 128, "entities": 128}, {"type": "Government & Defense", "events": 102, "entities": 102}, {"type": "Others", "events": 94, "entities": 94}, {"type": "Financial Services", "events": 89, "entities": 89}, {"type": "Transportation", "events": 58, "entities": 58}, {"type": "Education", "events": 52, "entities": 52}, {"type": "Infrastructure", "events": 33, "entities": 33}, {"type": "Telecommunications", "events": 26, "entities": 26}, {"type": "Professional Services", "events": 25, "entities": 25}, {"type": "Unknown", "events": 14, "entities": 14}, {"type": "Not for Profit", "events": 8, "entities": 8}]};
    const recordsHistogram = {"bins": ["1-10", "11-100", "101-1K", "1K-10K", "10K-100K", "100K-1M", "1M-10M", "10M+"], "frequencies": [0, 11, 30, 58, 111, 83, 73, 53]};
    const maxRecordsPerMonth = {"months": ["2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06", "2025-07", "2025-08", "2025-09", "2025-10", "2025-11", "2025-12", "2026-01"], "max_records": [12900000, 19900, 5700000, 8800, 444000, 33000000, 77159696, 9700000, 77159696, 114000000, 500, 100000, 11000000, 5700000, 31500, 80000, 700000000, 1500, 1850000, 1200000, 10000000, 8200000, 8200000, 928760, 500000, 548000, 500, 285631, 193000, 9700000, 11000000, 11000000, 9700000, 5700000, 130000, 14000000, 328000, 14000000, 2500000, 2800000, 1240000, 193000, 193000, 1240000, 50000, 12900000, 100000, 25000000, 762856, 14000000, 560000000, 17643173, 1100000, 8500000, 299006, 150000000, 31000000, 800000, 400000, 2369481, 320000, 5700000, 6000000, 8094, 64000000, 310000, 780000, 5700000, 300000, 665000, 50000, 300000], "titles": ["NSW Health Data Breach Exposes Sensitive Staff Records, Raising ...", "UTAS contacts 19,900 students caught up in data breach", "Mobile Phishing (Smishing) Campaign Targeting Telecommunications Customers", "Confidential details of entire WA Police Force accessed in 'startling' audit breach, CCC finds", "Australian universities investigating 'deeply concerning' hack of controversial exam software", "Google Chrome Security Breach: 33 Million Downloads Of Spyware", "Nitro PDF suffers massive data breach, exposing Microsoft, Google, Amazon documents", "Scattered Spider Ransomware Attacks Target Australian Healthcare Sector", "Exploitation of Unitronics Programmable Logic Controllers (PLCs ...", "Gravatar profile add-on leaks data on millions of users", "Data theft at Australian Securities and Investments Commission (ASIC)", "ASIC experiences four error-caused data breaches since start of 2022", "Telstra explains how internal data breach exposed more than 130,000 customers' details", "SITA data breach affects millions of airline passengers", "Cyber Attack on Major Private Hospital Group (April 2021)", "South Australian Government Payroll Data Breach via Frontier Software Ransomware Attack", "LinkedIn data from 700 million users for sale on hacking forum", "Kaseya VSA Supply-Chain Ransomware Attack | Cyber.gov.au", "The Good Guys customers possibly affected by data breach at former third-party provider My Rewards", "Cybersecurity experts weigh in on GoDaddy data breach", "Twitch hack reveals multi-million-dollar sums top streamers earn from playing computer games", "Okta says third-party breach may have impacted up to 366 customers", "Afterpay shareholders sue Dorsey\u2019s Block for breach disclosure", "Vinomofo did not protect personal information from security risks, Privacy Commissioner finds", "NSW nurses strike as data breach defended", "Microsoft Data Breach (Australia)", "TfNSW hit by second cyber attack in less than 18 months", "Leak of Nauru Police Force Files Related to Australian Offshore Processing", "Icare data breach due to \u2018human error\u2019, agency says", "Woolworths MyDeal Data Breach", "Australia Blames Russian Hacker for Major Cyber Attack - The ...", "Optus fined $826,000 over Coles Mobile scam security breach | The ...", "Australian Healthcare Under Cyber Attack: Adactin's Solution ...", "Privacy complaints | Queensland Health", "Telstra blames privacy breach on 'database misalignment'", "Latitude Financial Services Data Breach", "Data Matching between Medicare and Centrelink records and ...", "Recent Data Breaches \u2013 advice for foreign passport holders", "Acting against unknown hackers a groundbreaking ... - Dentons", "Amazon Says Employee Data Impacted In Third-Party Breach", "Dymocks warns customers of data breach after account information leaked on dark web", "Pizza Hut Australia Data Breach", "Pizza Hut says nearly two-hundred thousand customers affected by ...", "Dymocks links data breach to \"external data partner\"", "Charity donor details\u2026 - Institute of Community Directors Australia", "MediSecure cyber incident | NSW Government", "Nissan A/NZ's outsourced cyber incident call centre breached", "DJI suffers alleged data breach at the hands of R00TK1T", "Homeowners urged to be vigilant for scams after \u2018shocking\u2019 data breach at major smoke alarm provider", "Sale of 14 Million Australian Emails and Addresses on Hacking Forum", "Live Nation probing Ticketmaster hack", "Cyberattacks Australia 2024 | KonBriefing.com", "Total Tools data leak: Popular hardware chain impacted by 'cyber ...", "Widespread outages relating to CrowdStrike software update ...", "Fortinet suffers third-party data breach affecting Asia-Pacific ...", "MoneyGram confirms data breach after major outage", "What is the Internet Archive, and what could a full-scale hack on its data mean?", "Navigating the privacy risks of electric vehicles - Law Society Journal", "SquareX reveals critical breach of Cyberhaven extension", "BREAKING NEWS:JB Hi FI Denies Massive Cyber Attack Claim", "Cybersecurity Incident Impacting Compumedics Limited ...", "Beyond Qantas' data leak, Australian finance companies are also at ...", "Queensland data security breach exposes data of thousands as ...", "O&G Adelaide Ransomware Leak", "McDonald's AI chatbot hacked leaving Aussie job applicants exposed", "iiNet cyber incident | The Telecommunications Industry Ombudsman", "Who's Hacked? Latest Data Breaches And Cyberattacks", "Australian Telecommunications Company Portal Access", "Rental car insurer Prosura confirms cyber incident as alleged threat ...", "Victorian Department of Education Data Breach", "List of Cyber Attacks and Data Breaches in Australia", "14th January 2026 Cyber Update: Prosura Breach Exposes 300,000 Customers"], "entities": ["New South Wales Ministry of Health", "University of Tasmania", "Unknown", "Office of the Auditor General for Western Australia", "ProctorU (vendor breach affecting multiple Australian universities)", "Alphabet Inc.", "Nitro Software Inc.", "Unknown", "Unknown", "Automattic Inc.", "Australian Securities and Investments Commission", "Australian Securities and Investments Commission", "Telstra Corporation Limited", "Soci\u00e9t\u00e9 Internationale de T\u00e9l\u00e9communications A\u00e9ronautiques SC", "Unknown", "Government of South Australia", "LinkedIn Corporation", "Kaseya Limited", "Pegasus Group Australia Pty Ltd (now My Rewards Pty Ltd)", "GoDaddy Inc.", "Twitch Interactive, Inc.", "Okta, Inc.", "Afterpay Limited", "Vinomofo Pty Ltd", "NSW Government", "Microsoft Corporation", "Transport for New South Wales", "Nauru Police Force", "Insurance and Care NSW", "MyDeal (Woolworths Group subsidiary)", "Medibank Private Limited", "Optus Mobile Pty Limited", "Unknown", "Queensland Health", "Telstra Corporation Limited", "Latitude Group Holdings Limited", "KindSIGHT", "Latitude Financial Services Pty Ltd", "HWLE", "Amazon.com, Inc.", "Dymocks Holdings Pty Ltd", "Pizza Hut Australia Pty Ltd", "Pizza Pan Group Pty Ltd", "Unknown", "Institute of Community Directors Australia Limited", "Unknown", "Nissan Motor Co. (Australia) Pty Ltd", "SZ DJI Technology Co., Ltd.", "Smoke Alarm Solutions Pty Ltd", "Unknown", "Live Nation Entertainment, Inc.", "Victoria Racing Club Limited", "Total Tools Holdings Pty Ltd", "CrowdStrike Holdings, Inc.", "Fortinet, Inc.", "MoneyGram International Inc.", "Internet Archive", "Volkswagen AG", "Cyberhaven, Inc.", "JB Hi-Fi Limited", "Compumedics Limited", "Qantas Airways Limited", "Unknown", "O&G Adelaide Pty Ltd", "McDonald's Australia Limited", "iiNet Limited", "Ever Care Corporation", "Unknown", "Prosura", "Department of Education", "Unknown", "Department of Education"]};
    const recordsByAttackType = {"attack_types": ["Data Breach", "Ransomware", "Other", "Vulnerability Exploit", "Malware", "Denial Of Service", "State Sponsored Attack", "Infrastructure Attack", "Phishing", "Financial Fraud", "Identity Theft", "Supply Chain Attack"], "avg_records": [9320698.632183908, 1979746.5479452056, 2494015.12, 19293436.5, 5525333.333333333, 15503750.0, 6312366.5, 1555444.4444444445, 987500.0, 15000.0, 2031.0, 800.0]};
    const monthlyCountsStats = {"bins": ["1 - 4", "4 - 7", "7 - 10", "10 - 13", "13 - 16", "16 - 19", "19 - 22", "22 - 25", "25 - 28", "28 - 31"], "frequencies": [10, 11, 18, 12, 6, 5, 4, 3, 2, 2], "mean": 10.684931506849315, "variance": 46.133608556952545, "k_estimate": 3.2206494235228087, "model": "Over-dispersed (likely Negative Binomial)", "overdispersion": {"mean": 10.68, "variance": 46.77, "overdispersion_param": 4.378, "poisson_lambda": 10.68, "nb_n": 3.16, "nb_p": 0.228, "interpretation": "Negative Binomial"}};
    const eventTypeCorrelation = {"labels": ["Data Breach", "Ransomware", "Other", "Phishing", "State Sponsored Attack", "Infrastructure Attack", "Malware", "Vulnerability Exploit", "Denial Of Service"], "correlation_matrix": [[1.0, 0.234, 0.425, 0.119, 0.077, 0.261, 0.206, 0.094, -0.096], [0.234, 1.0, 0.361, 0.024, 0.19, 0.193, -0.051, -0.012, 0.021], [0.425, 0.361, 1.0, 0.24, 0.19, 0.315, 0.099, 0.165, -0.028], [0.119, 0.024, 0.24, 1.0, -0.141, 0.121, 0.293, 0.179, -0.084], [0.077, 0.19, 0.19, -0.141, 1.0, 0.089, 0.091, 0.103, -0.023], [0.261, 0.193, 0.315, 0.121, 0.089, 1.0, 0.087, 0.025, -0.095], [0.206, -0.051, 0.099, 0.293, 0.091, 0.087, 1.0, 0.775, 0.107], [0.094, -0.012, 0.165, 0.179, 0.103, 0.025, 0.775, 1.0, -0.077], [-0.096, 0.021, -0.028, -0.084, -0.023, -0.095, 0.107, -0.077, 1.0]], "min_correlation": -0.141, "max_correlation": 1.0};
    const oaicComparison = {"periods": ["2020 H1", "2020 H2", "2021 H1", "2021 H2", "2022 H1", "2022 H2", "2023 H1", "2023 H2", "2024 H1", "2024 H2", "2025 H1", "2025 H2", "2026 H1"], "database_counts": [57, 39, 45, 33, 33, 66, 63, 77, 93, 78, 115, 75, 6], "oaic_counts": [447, 512, 530, 436, 250, 350, 409, 483, 527, 2024, 532, null, null], "oaic_available": 11, "database_available": 13, "prorata_period": "2026 H1", "prorata_estimate": 68, "prorata_actual": 6};
    const oaicCyberIncidents = {"periods": ["2019 Q1", "2019 Q2", "2019 H2", "2020 H1", "2020 H2", "2021 H1", "2021 H2", "2022 H1", "2022 H2", "2023 H1", "2023 H2", "2024 H1", "2024 H2", "2025 H1"], "cyber_incidents": [null, null, 71, 308, 212, 192, 173, 162, 222, 172, 211, 200, 247, 178], "total_notifications": [215, 245, 106, 447, 512, 530, 436, 250, 350, 409, 483, 527, 2024, 532]};
    const oaicAttackTypes = {"periods": ["2019 Q1", "2019 Q2", "2019 H2", "2020 H1", "2020 H2", "2021 H1", "2021 H2", "2022 H1", "2022 H2", "2023 H1", "2023 H2", "2024 H1", "2024 H2", "2025 H1"], "attack_types": {"ransomware": [7, 8, 6, 15, 17, 24, 23, 51, 64, null, null, null, null, null], "phishing": [20, 4, 36, 36, 25, 30, 32, 42, null, 331, null, null, null, null], "hacking": [13, 8, 6, 13, 14, 9, 8, 13, null, 164, null, null, null, null], "malware": [13, 2, 10, 4, 7, 5, 3, 9, 109, 133, 10, 105, 122, null], "brute_force": [null, null, null, null, null, null, null, 200, null, null, null, null, null, null], "compromised_credentials": [null, 43, null, null, null, null, null, null, null, null, null, null, null, null]}};
    const oaicSectors = {"sectors": ["Retail", "Education", "Australian Government", "Health", "Finance"], "oaic_counts": [1066, 505, 453, 273, 136], "database_counts": [57, 36, 76, 89, 64], "ratios": [0.05, 0.07, 0.17, 0.33, 0.47], "sector_count": 5};
    const oaicIndividualsAffected = {"periods": ["2019 Q1", "2019 Q2", "2019 H2", "2020 H1", "2020 H2", "2021 H1", "2021 H2", "2022 H1", "2022 H2", "2023 H1", "2023 H2", "2024 H1", "2024 H2", "2025 H1"], "averages": [36993, 9479, 340, 486, 20117, 523998, 745, 134, 1328, 845, 9080, 107123, 15357, 5665.009671179884], "medians": [null, null, null, null, null, null, null, null, null, null, null, 341, 182, 55], "db_averages": [null, null, 67931625.0, 4079495.653846154, 15367958.368421054, 26932963.259259257, 1666109.2608695652, 227966.29166666666, 4502451.255319149, 3720018.7045454546, 1635747.6666666667, 18331462.30612245, 7761980.3, 2675180.32]};
    const asdRiskAll = {"impact_types": ["Sustained disruption of essential systems and associated services", "Extensive compromise", "Isolated compromise", "Coordinated low-level malicious attack", "Low-level malicious attack", "Unsuccessful low-level malicious attack"], "stakeholder_groups": ["Member(s) of the public", "Small organisation(s) / Sole traders", "Medium-sized organisation(s) / Schools / Local government", "State government / Academia/R&D / Large organisation(s) / Supply chain", "Federal government / Government shared services / Regulated critical infrastructure", "National security / Systems of National Significance"], "matrix": [{"impact_type": "Sustained disruption of essential systems and associated services", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 1, "State government / Academia/R&D / Large organisation(s) / Supply chain": 11, "Federal government / Government shared services / Regulated critical infrastructure": 11, "National security / Systems of National Significance": 1}}, {"impact_type": "Extensive compromise", "counts": {"Member(s) of the public": 12, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 20, "State government / Academia/R&D / Large organisation(s) / Supply chain": 204, "Federal government / Government shared services / Regulated critical infrastructure": 74, "National security / Systems of National Significance": 3}}, {"impact_type": "Isolated compromise", "counts": {"Member(s) of the public": 4, "Small organisation(s) / Sole traders": 11, "Medium-sized organisation(s) / Schools / Local government": 95, "State government / Academia/R&D / Large organisation(s) / Supply chain": 193, "Federal government / Government shared services / Regulated critical infrastructure": 41, "National security / Systems of National Significance": 0}}, {"impact_type": "Coordinated low-level malicious attack", "counts": {"Member(s) of the public": 1, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 1, "Federal government / Government shared services / Regulated critical infrastructure": 0, "National security / Systems of National Significance": 0}}, {"impact_type": "Low-level malicious attack", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 1, "Medium-sized organisation(s) / Schools / Local government": 7, "State government / Academia/R&D / Large organisation(s) / Supply chain": 7, "Federal government / Government shared services / Regulated critical infrastructure": 2, "National security / Systems of National Significance": 0}}, {"impact_type": "Unsuccessful low-level malicious attack", "counts": {"Member(s) of the public": 10, "Small organisation(s) / Sole traders": 7, "Medium-sized organisation(s) / Schools / Local government": 20, "State government / Academia/R&D / Large organisation(s) / Supply chain": 58, "Federal government / Government shared services / Regulated critical infrastructure": 25, "National security / Systems of National Significance": 1}}], "total_classifications": 821, "max_value": 204, "year": null};
    const asdRiskCurrent = {"impact_types": ["Sustained disruption of essential systems and associated services", "Extensive compromise", "Isolated compromise", "Coordinated low-level malicious attack", "Low-level malicious attack", "Unsuccessful low-level malicious attack"], "stakeholder_groups": ["Member(s) of the public", "Small organisation(s) / Sole traders", "Medium-sized organisation(s) / Schools / Local government", "State government / Academia/R&D / Large organisation(s) / Supply chain", "Federal government / Government shared services / Regulated critical infrastructure", "National security / Systems of National Significance"], "matrix": [{"impact_type": "Sustained disruption of essential systems and associated services", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 0, "Federal government / Government shared services / Regulated critical infrastructure": 0, "National security / Systems of National Significance": 0}}, {"impact_type": "Extensive compromise", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 1, "Federal government / Government shared services / Regulated critical infrastructure": 1, "National security / Systems of National Significance": 0}}, {"impact_type": "Isolated compromise", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 2, "Federal government / Government shared services / Regulated critical infrastructure": 1, "National security / Systems of National Significance": 0}}, {"impact_type": "Coordinated low-level malicious attack", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 0, "Federal government / Government shared services / Regulated critical infrastructure": 0, "National security / Systems of National Significance": 0}}, {"impact_type": "Low-level malicious attack", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 0, "Federal government / Government shared services / Regulated critical infrastructure": 0, "National security / Systems of National Significance": 0}}, {"impact_type": "Unsuccessful low-level malicious attack", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 1, "Federal government / Government shared services / Regulated critical infrastructure": 0, "National security / Systems of National Significance": 0}}], "total_classifications": 6, "max_value": 2, "year": 2026};
    const asdRiskPrevious = {"impact_types": ["Sustained disruption of essential systems and associated services", "Extensive compromise", "Isolated compromise", "Coordinated low-level malicious attack", "Low-level malicious attack", "Unsuccessful low-level malicious attack"], "stakeholder_groups": ["Member(s) of the public", "Small organisation(s) / Sole traders", "Medium-sized organisation(s) / Schools / Local government", "State government / Academia/R&D / Large organisation(s) / Supply chain", "Federal government / Government shared services / Regulated critical infrastructure", "National security / Systems of National Significance"], "matrix": [{"impact_type": "Sustained disruption of essential systems and associated services", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 1, "State government / Academia/R&D / Large organisation(s) / Supply chain": 1, "Federal government / Government shared services / Regulated critical infrastructure": 0, "National security / Systems of National Significance": 0}}, {"impact_type": "Extensive compromise", "counts": {"Member(s) of the public": 1, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 5, "State government / Academia/R&D / Large organisation(s) / Supply chain": 29, "Federal government / Government shared services / Regulated critical infrastructure": 8, "National security / Systems of National Significance": 0}}, {"impact_type": "Isolated compromise", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 5, "Medium-sized organisation(s) / Schools / Local government": 28, "State government / Academia/R&D / Large organisation(s) / Supply chain": 52, "Federal government / Government shared services / Regulated critical infrastructure": 9, "National security / Systems of National Significance": 0}}, {"impact_type": "Coordinated low-level malicious attack", "counts": {"Member(s) of the public": 1, "Small organisation(s) / Sole traders": 0, "Medium-sized organisation(s) / Schools / Local government": 0, "State government / Academia/R&D / Large organisation(s) / Supply chain": 1, "Federal government / Government shared services / Regulated critical infrastructure": 0, "National security / Systems of National Significance": 0}}, {"impact_type": "Low-level malicious attack", "counts": {"Member(s) of the public": 0, "Small organisation(s) / Sole traders": 1, "Medium-sized organisation(s) / Schools / Local government": 2, "State government / Academia/R&D / Large organisation(s) / Supply chain": 3, "Federal government / Government shared services / Regulated critical infrastructure": 1, "National security / Systems of National Significance": 0}}, {"impact_type": "Unsuccessful low-level malicious attack", "counts": {"Member(s) of the public": 2, "Small organisation(s) / Sole traders": 5, "Medium-sized organisation(s) / Schools / Local government": 10, "State government / Academia/R&D / Large organisation(s) / Supply chain": 17, "Federal government / Government shared services / Regulated critical infrastructure": 8, "National security / Systems of National Significance": 0}}], "total_classifications": 190, "max_value": 52, "year": 2025};

    const colors = {
      primary: '#2563eb',
      secondary: '#10b981',
      success: '#10b981',
      warning: '#f59e0b',
      danger: '#ef4444',
      info: '#06b6d4',
      severity: {
        'Critical': '#dc2626', 'High': '#ea580c', 'Medium': '#ca8a04', 'Low': '#16a34a', 'Unknown': '#6b7280'
      }
    };

    function renderRiskMatrix(targetId, matrixData, totalId) {
      const container = document.getElementById(targetId);
      const totalElement = totalId ? document.getElementById(totalId) : null;
      if (!container) return;

      if (!matrixData || !Array.isArray(matrixData.matrix) || matrixData.matrix.length === 0) {
        container.innerHTML = '<p class="text-muted mb-0">No ASD risk classifications available.</p>';
        if (totalElement) totalElement.textContent = '0';
        return;
      }

      const groups = matrixData.stakeholder_groups || [];
      const matrixRows = matrixData.matrix;
      const maxValue = matrixData.max_value || 0;

      const colorForValue = (value) => {
        if (!value || !maxValue) return '';
        const opacity = 0.18 + 0.72 * (value / maxValue);
        const textColor = opacity > 0.45 ? '#ffffff' : '#111827';
        return `background-color: rgba(37, 99, 235, ${opacity.toFixed(3)}); color: ${textColor};`;
      };

      let html = '<div class="table-responsive"><table class="table table-sm table-bordered align-middle text-center mb-1">';
      html += '<thead><tr><th class="text-start">Impact Type</th>';
      groups.forEach(group => { html += `<th class="group-header">${group}</th>`; });
      html += '</tr></thead><tbody>';

      matrixRows.forEach(row => {
        html += `<tr><th scope="row" class="text-start impact-label">${row.impact_type}</th>`;
        groups.forEach(group => {
          const value = (row.counts && row.counts[group]) ? row.counts[group] : 0;
          const display = value > 0 ? value : '';
          const style = colorForValue(value);
          html += `<td style="${style}">${display}</td>`;
        });
        html += '</tr>';
      });

      html += '</tbody></table></div>';
      container.innerHTML = html;

      if (totalElement) {
        totalElement.textContent = (matrixData.total_classifications || 0).toLocaleString();
      }
    }

    renderRiskMatrix('asdRiskMatrixAll', asdRiskAll, 'asdAllTotal');
    renderRiskMatrix('asdRiskMatrixCurrent', asdRiskCurrent, 'asdCurrentTotal');
    renderRiskMatrix('asdRiskMatrixPrevious', asdRiskPrevious, 'asdPreviousTotal');

    // 1) Monthly Trends (line) with trend line
    (function() {
      const counts = monthlyCounts.counts;
      const n = counts.length;

      // Calculate linear regression for trend line
      let sumX = 0, sumY = 0, sumXY = 0, sumXX = 0;
      for (let i = 0; i < n; i++) {
        sumX += i;
        sumY += counts[i];
        sumXY += i * counts[i];
        sumXX += i * i;
      }

      const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);
      const intercept = (sumY - slope * sumX) / n;

      // Generate trend line data
      const trendLine = [];
      for (let i = 0; i < n; i++) {
        trendLine.push(slope * i + intercept);
      }

      new Chart(document.getElementById('monthlyTrendsChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: monthlyCounts.months,
          datasets: [
            {
              label: 'Unique Events',
              data: counts,
              borderColor: colors.primary,
              backgroundColor: '#2563eb20',
              fill: true,
              tension: 0.4,
              order: 2
            },
            {
              label: 'Trend',
              data: trendLine,
              borderColor: '#dc2626',
              backgroundColor: 'transparent',
              borderWidth: 2,
              borderDash: [5, 5],
              fill: false,
              tension: 0,
              pointRadius: 0,
              order: 1
            }
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              position: 'top'
            }
          },
          scales: {
            y: { beginAtZero: true },
            x: { title: { display: true, text: 'Month' }}
          }
        }
      });
    })();

    // 2) Severity Trends (stacked bar)
    const sevDatasets = Object.keys(severityTrends.data).map(sev => ({
      label: sev,
      data: severityTrends.data[sev],
      backgroundColor: colors.severity[sev] || '#6b7280',
      borderColor: colors.severity[sev] || '#6b7280',
    }));
    new Chart(document.getElementById('severityTrendsChart').getContext('2d'), {
      type: 'bar',
      data: { labels: severityTrends.months, datasets: sevDatasets },
      options: {
        responsive: true, maintainAspectRatio: false,
        plugins: { legend: { position: 'top' } },
        scales: {
          x: { stacked: true, title: { display: true, text: 'Month' }},
          y: { stacked: true, beginAtZero: true, title: { display: true, text: 'Events' }}
        }
      }
    });

    // 3) Records Affected (line, log scale) with Average and Median
    new Chart(document.getElementById('recordsAffectedChart').getContext('2d'), {
      type: 'line',
      data: {
        labels: recordsAffected.months,
        datasets: [
          {
            label: 'Average Records Affected',
            data: recordsAffected.averages,
            borderColor: colors.secondary,
            backgroundColor: '#10b98120',
            fill: false,
            tension: 0.4,
            borderWidth: 2
          },
          {
            label: 'Median Records Affected',
            data: recordsAffected.medians,
            borderColor: colors.primary,
            backgroundColor: '#2563eb20',
            fill: false,
            tension: 0.4,
            borderWidth: 2,
            borderDash: [5, 5]
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: true,
            position: 'top'
          }
        },
        scales: {
          y: {
            type: 'logarithmic',
            beginAtZero: true,
            title: { display: true, text: 'Records (log)' }
          },
          x: {
            title: { display: true, text: 'Month' }
          }
        }
      }
    });

    // 4) Event Type Mix (stacked bar)
    function generateUniqueColors(n) {
      // Golden angle based distinct colors
      const colors = [];
      const golden = 137.508;
      for (let i = 0; i < n; i++) {
        const hue = (i * golden) % 360;
        const sat = 70;
        const light = 50;
        colors.push(`hsl(${hue}, ${sat}%, ${light}%)`);
      }
      return colors;
    }
    const etKeys = Object.keys(eventTypeMix.types);
    const uniqueColors = generateUniqueColors(etKeys.length);
    const etDatasets = etKeys.map((t, i) => ({
      label: t,
      data: eventTypeMix.types[t],
      backgroundColor: uniqueColors[i],
      borderColor: uniqueColors[i]
    }));
    new Chart(document.getElementById('eventTypeMixChart').getContext('2d'), {
      type: 'bar',
      data: { labels: eventTypeMix.months, datasets: etDatasets },
      options: {
        responsive: true, maintainAspectRatio: false,
        plugins: { legend: { position: 'top' }},
        scales: { x: { stacked: true }, y: { stacked: true, beginAtZero: true }}
      }
    });

    // 5) Entity Type Distribution (doughnut)
    const entityLabels = entityTypes.types.map(t => t.type);
    const entityValues = entityTypes.types.map(t => t.events);
    new Chart(document.getElementById('entityTypeChart').getContext('2d'), {
      type: 'doughnut',
      data: { labels: entityLabels, datasets: [{ data: entityValues, backgroundColor: entityLabels.map((_, i) => `hsl(${(i*360/entityLabels.length)||0},70%,50%)`) }]},
      options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right' }}}
    });

    // 6) Overall Event Type Mix (pie)
    (function(){
      const labels = overallEventTypeMix.labels || [];
      const counts = overallEventTypeMix.counts || [];
      const colors = generateUniqueColors(labels.length);
      new Chart(document.getElementById('overallEventTypePieChart').getContext('2d'), {
        type: 'pie',
        data: { labels, datasets: [{ data: counts, backgroundColor: colors, borderColor: colors }]},
        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right' }}}
      });
    })();

    // 6) Records Histogram (bar)
    new Chart(document.getElementById('recordsHistogramChart').getContext('2d'), {
      type: 'bar',
      data: { labels: recordsHistogram.bins, datasets: [{ label: 'Frequency', data: recordsHistogram.frequencies, backgroundColor: '#06b6d480', borderColor: '#06b6d4' }]},
      options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }}, scales: { y: { beginAtZero: true }}}
    });

    // 7) Histogram of Monthly Unique Event Counts + dispersion stats
    new Chart(document.getElementById('monthlyCountsHistChart').getContext('2d'), {
      type: 'bar',
      data: { labels: monthlyCountsStats.bins, datasets: [{ label: 'Months', data: monthlyCountsStats.frequencies, backgroundColor: '#64748b80', borderColor: '#64748b' }]},
      options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }}, scales: { y: { beginAtZero: true }}}
    });
    (function(){
      const s = monthlyCountsStats;
      const od = s.overdispersion || {};
      const statsEl = document.getElementById('monthlyCountsStats');
      const subtitleEl = document.getElementById('monthlyCountsSubtitle');

      // Calculate and display overdispersion percentage in subtitle
      const mean = od.mean || s.mean;
      const variance = od.variance || s.variance;
      if (mean && variance && mean > 0) {
        const overdispersionPct = ((variance - mean) / mean * 100).toFixed(1);
        if (variance > mean) {
          subtitleEl.textContent = `Overdispersion: +${overdispersionPct}% vs Poisson`;
        } else if (variance < mean) {
          subtitleEl.textContent = `Underdispersion: ${overdispersionPct}% vs Poisson`;
        } else {
          subtitleEl.textContent = `Dispersion: 0% vs Poisson (perfect match)`;
        }
      }

      // Create formatted display with overdispersion analysis
      if (od.overdispersion_param) {
        const phi = od.overdispersion_param;
        const interpretation = od.interpretation || s.model;

        statsEl.innerHTML = `
          <div style="font-weight: 600; margin-bottom: 4px;">
            Overdispersion Analysis: œÜ = ${phi} (${interpretation})
          </div>
          <div style="font-size: 0.85rem;">
            Mean: ${od.mean} ‚Ä¢ Variance: ${od.variance} ‚Ä¢
            ${phi > 1.5 ? `Negative Binomial (n=${od.nb_n}, p=${od.nb_p})` :
              phi < 1.2 ? `Poisson (Œª=${od.poisson_lambda})` :
              'Mixed distribution'}
          </div>
        `;
      } else {
        // Fallback to old format if overdispersion not available
        const lines = [];
        lines.push(`Mean: ${s.mean?.toFixed ? s.mean.toFixed(2) : s.mean}`);
        lines.push(`Variance: ${s.variance?.toFixed ? s.variance.toFixed(2) : s.variance}`);
        if (s.k_estimate) lines.push(`NB dispersion k (est.): ${s.k_estimate.toFixed ? s.k_estimate.toFixed(2) : s.k_estimate}`);
        lines.push(`Model: ${s.model}`);
        statsEl.textContent = lines.join(' ‚Ä¢ ');
      }
    })();

    // 9) OAIC Comparison Chart
    (function(){
      const oaic = oaicComparison;
      if (!oaic.periods || oaic.periods.length === 0) {
        document.getElementById('oaicComparisonChart').parentElement.innerHTML =
          '<div class="chart-title">Database vs OAIC Official Notifications (Half-Yearly)</div>' +
          '<div class="text-center text-muted mt-5"><p>No OAIC data available.<br>Run <code>python oaic_data_scraper.py</code> first.</p></div>';
        return;
      }

      const datasets = [
        {
          label: 'Database Events',
          data: oaic.database_counts,
          borderColor: colors.primary,
          backgroundColor: colors.primary + '20',
          fill: false,
          tension: 0.1,
          pointRadius: 5
        }
      ];

      // Only add OAIC dataset if we have OAIC data
      if (oaic.oaic_available > 0) {
        datasets.push({
          label: 'OAIC Official Notifications',
          data: oaic.oaic_counts,
          borderColor: colors.danger,
          backgroundColor: colors.danger + '20',
          fill: false,
          tension: 0.1,
          pointRadius: 5,
          spanGaps: false  // Don't connect points where data is missing
        });
      }

      // Add pro-rata estimate if available
      if (oaic.prorata_estimate && oaic.prorata_period) {
        // Create array with null values except for the last period
        const prorataData = oaic.periods.map((p, idx) =>
          (p === oaic.prorata_period && idx === oaic.periods.length - 1) ? oaic.prorata_estimate : null
        );

        datasets.push({
          label: 'Estimated Full Period (Pro-rata)',
          data: prorataData,
          borderColor: colors.secondary,
          backgroundColor: colors.secondary,
          fill: false,
          tension: 0,
          pointRadius: 8,
          pointStyle: 'triangle',
          showLine: false  // Don't draw lines between points
        });
      }

      new Chart(document.getElementById('oaicComparisonChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: oaic.periods,
          datasets: datasets
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'top'
            },
            tooltip: {
              callbacks: {
                footer: function(tooltipItems) {
                  const dbCount = tooltipItems.find(item => item.datasetIndex === 0);
                  const oaicCount = tooltipItems.find(item => item.datasetIndex === 1);

                  if (dbCount && oaicCount && oaicCount.raw !== null) {
                    const ratio = (dbCount.raw / oaicCount.raw).toFixed(2);
                    return `Ratio (DB/OAIC): ${ratio}x`;
                  }
                  return '';
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'Number of Events/Notifications'
              }
            },
            x: {
              title: {
                display: true,
                text: 'Half-Year Period'
              }
            }
          }
        }
      });

      // Add summary statistics
      const stats = [];
      stats.push(`Database periods: ${oaic.database_available}`);
      if (oaic.oaic_available > 0) {
        stats.push(`OAIC periods: ${oaic.oaic_available}`);

        // Calculate ratios for overlapping periods
        const ratios = [];
        for (let i = 0; i < oaic.periods.length; i++) {
          const dbCount = oaic.database_counts[i];
          const oaicCount = oaic.oaic_counts[i];
          if (dbCount && oaicCount) {
            ratios.push(dbCount / oaicCount);
          }
        }

        if (ratios.length > 0) {
          const avgRatio = ratios.reduce((a, b) => a + b, 0) / ratios.length;
          stats.push(`Avg ratio (DB/OAIC): ${avgRatio.toFixed(2)}x`);
        }
      } else {
        stats.push('OAIC: No data available');
      }

      // Add pro-rata estimate information if available
      if (oaic.prorata_estimate && oaic.prorata_period) {
        stats.push(`${oaic.prorata_period} (partial): ${oaic.prorata_actual} ‚Üí Est. ${oaic.prorata_estimate}`);
      }

      document.getElementById('oaicComparisonStats').textContent = stats.join(' ‚Ä¢ ');
    })();

    // 10) OAIC Cyber Incidents Chart
    (function(){
      const data = oaicCyberIncidents;
      if (!data.periods || data.periods.length === 0) {
        document.getElementById('oaicCyberIncidentsChart').parentElement.innerHTML =
          '<div class="chart-title">OAIC Cyber Incidents vs Total Notifications</div>' +
          '<div class="text-center text-muted mt-5"><p>No OAIC data available.</p></div>';
        return;
      }

      new Chart(document.getElementById('oaicCyberIncidentsChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: data.periods,
          datasets: [
            {
              label: 'Cyber Incidents',
              data: data.cyber_incidents,
              borderColor: colors.danger,
              backgroundColor: colors.danger + '20',
              fill: true,
              tension: 0.3
            },
            {
              label: 'Total Notifications',
              data: data.total_notifications,
              borderColor: colors.primary,
              backgroundColor: colors.primary + '20',
              fill: true,
              tension: 0.3
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false
          },
          scales: {
            y: {
              type: 'linear',
              position: 'left',
              beginAtZero: true,
              title: {
                display: true,
                text: 'Count'
              }
            }
          }
        }
      });
    })();

    // 11) OAIC Attack Types Chart
    (function(){
      const data = oaicAttackTypes;
      if (!data.periods || data.periods.length === 0) {
        document.getElementById('oaicAttackTypesChart').parentElement.innerHTML =
          '<div class="chart-title">OAIC Attack Types Over Time</div>' +
          '<div class="text-center text-muted mt-5"><p>No OAIC data available.</p></div>';
        return;
      }

      const datasets = [];
      const attackColors = {
        'ransomware': '#dc2626',
        'phishing': '#ea580c',
        'hacking': '#ca8a04',
        'malware': '#16a34a',
        'brute_force': '#0891b2',
        'compromised_credentials': '#7c3aed'
      };

      for (const [attackType, values] of Object.entries(data.attack_types)) {
        datasets.push({
          label: attackType.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase()),
          data: values,
          borderColor: attackColors[attackType] || colors.primary,
          backgroundColor: (attackColors[attackType] || colors.primary) + '20',
          fill: false,
          tension: 0.3
        });
      }

      new Chart(document.getElementById('oaicAttackTypesChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: data.periods,
          datasets: datasets
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false
          },
          plugins: {
            legend: {
              position: 'top'
            }
          }
        }
      });
    })();

    // 12) OAIC Top Sectors Chart
    (function(){
      const data = oaicSectors;
      if (!data.sectors || data.sectors.length === 0) {
        document.getElementById('oaicSectorsChart').parentElement.innerHTML =
          '<div class="chart-title">OAIC Top Affected Sectors (2020-2025)</div>' +
          '<div class="text-center text-muted mt-5"><p>No OAIC data available.</p></div>';
        return;
      }

      // Update title based on actual sector count
      const sectorCount = data.sector_count || data.sectors.length;
      document.getElementById('oaicSectorsTitle').textContent =
        `OAIC Top ${sectorCount} Affected Sectors (2020-2025)`;

      new Chart(document.getElementById('oaicSectorsChart').getContext('2d'), {
        type: 'bar',
        data: {
          labels: data.sectors,
          datasets: [
            {
              label: 'OAIC Official Count',
              data: data.oaic_counts,
              backgroundColor: colors.primary,
              borderColor: colors.primary,
              borderWidth: 1
            },
            {
              label: 'Database Count',
              data: data.database_counts,
              backgroundColor: colors.success,
              borderColor: colors.success,
              borderWidth: 1
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          indexAxis: 'y',
          plugins: {
            legend: {
              display: true,
              position: 'top'
            }
          },
          scales: {
            x: {
              title: {
                display: true,
                text: 'Total Notifications (2020-2025)'
              }
            }
          }
        }
      });
    })();

    // 12b) OAIC Sector Ratio Chart (Database/OAIC)
    (function(){
      const data = oaicSectors;
      if (!data.sectors || data.sectors.length === 0 || !data.ratios) {
        document.getElementById('oaicSectorRatioChart').parentElement.innerHTML =
          '<div class="chart-title">Database/OAIC Ratio by Sector</div>' +
          '<div class="text-center text-muted mt-5"><p>No ratio data available.</p></div>';
        return;
      }

      // Convert ratios to percentages and color bars (green if >= 100%, orange if < 100%)
      const ratiosPct = data.ratios.map(r => Math.round(r * 100));
      const barColors = ratiosPct.map(r => r >= 100 ? colors.success : colors.warning);

      new Chart(document.getElementById('oaicSectorRatioChart').getContext('2d'), {
        type: 'bar',
        data: {
          labels: data.sectors,
          datasets: [
            {
              label: 'Database/OAIC %',
              data: ratiosPct,
              backgroundColor: barColors,
              borderColor: barColors,
              borderWidth: 1
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          indexAxis: 'y',
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  const pct = context.raw;
                  const idx = context.dataIndex;
                  const dbCount = data.database_counts[idx];
                  const oaicCount = data.oaic_counts[idx];
                  return [
                    `Coverage: ${pct}%`,
                    `Database: ${dbCount}`,
                    `OAIC: ${oaicCount}`
                  ];
                }
              }
            },
            annotation: {
              annotations: {
                line1: {
                  type: 'line',
                  xMin: 100,
                  xMax: 100,
                  borderColor: '#ef4444',
                  borderWidth: 2,
                  borderDash: [5, 5],
                  label: {
                    display: true,
                    content: '100%',
                    position: 'end'
                  }
                }
              }
            }
          },
          scales: {
            x: {
              title: {
                display: true,
                text: 'Database Coverage of OAIC Count (%)'
              },
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return value + '%';
                }
              }
            }
          }
        }
      });
    })();

    // 13) OAIC Individuals Affected Chart
    (function(){
      const data = oaicIndividualsAffected;
      if (!data.periods || data.periods.length === 0) {
        document.getElementById('oaicIndividualsAffectedChart').parentElement.innerHTML =
          '<div class="chart-title">OAIC Individuals Affected Trends</div>' +
          '<div class="text-center text-muted mt-5"><p>No OAIC data available.</p></div>';
        return;
      }

      new Chart(document.getElementById('oaicIndividualsAffectedChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: data.periods,
          datasets: [
            {
              label: 'OAIC Average Individuals Affected',
              data: data.averages,
              borderColor: colors.danger,
              backgroundColor: colors.danger + '20',
              fill: true,
              tension: 0.3
            },
            {
              label: 'OAIC Median Individuals Affected',
              data: data.medians,
              borderColor: colors.primary,
              backgroundColor: colors.primary + '20',
              fill: true,
              tension: 0.3
            },
            {
              label: 'Database Average Records Affected',
              data: data.db_averages,
              borderColor: colors.success,
              backgroundColor: colors.success + '20',
              fill: true,
              tension: 0.3
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false
          },
          plugins: {
            legend: {
              position: 'top'
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  let label = context.dataset.label || '';
                  if (label) {
                    label += ': ';
                  }
                  if (context.parsed.y !== null) {
                    label += new Intl.NumberFormat('en-US').format(context.parsed.y);
                  }
                  return label;
                }
              }
            }
          },
          scales: {
            y: {
              type: 'logarithmic',
              title: {
                display: true,
                text: 'Number of Individuals (log scale)'
              },
              ticks: {
                callback: function(value) {
                  return new Intl.NumberFormat('en-US', { notation: 'compact' }).format(value);
                }
              }
            }
          }
        }
      });
    })();

    // 14) Event Type Correlation Matrix
    (function(){
      const corr = eventTypeCorrelation;
      if (!corr.labels || corr.labels.length === 0) {
        document.getElementById('correlationMatrixChart').parentElement.innerHTML =
          '<div class="chart-title">Event Type Correlation Matrix (Monthly Counts)</div>' +
          '<div class="text-center text-muted mt-5"><p>Insufficient data for correlation analysis.<br>Need at least 2 event types with 5+ months of data.</p></div>';
        return;
      }

      const labels = corr.labels;
      const matrix = corr.correlation_matrix;
      
      // Create a custom heatmap using HTML table since Chart.js doesn't have a native heatmap
      const canvas = document.getElementById('correlationMatrixChart');
      const ctx = canvas.getContext('2d');
      const container = canvas.parentElement;
      
      // Create table-based heatmap
      const table = document.createElement('table');
      table.style.width = '100%';
      table.style.height = '100%';
      table.style.borderCollapse = 'collapse';
      table.style.fontSize = '12px';
      table.style.tableLayout = 'fixed';
      
      // Create header row
      const headerRow = document.createElement('tr');
      const emptyCell = document.createElement('th');
      emptyCell.style.border = '1px solid #ddd';
      emptyCell.style.padding = '8px';
      emptyCell.style.backgroundColor = '#f8f9fa';
      headerRow.appendChild(emptyCell);
      
      labels.forEach(label => {
        const th = document.createElement('th');
        th.textContent = label;
        th.style.border = '1px solid #ddd';
        th.style.padding = '6px 8px';
        th.style.backgroundColor = '#f8f9fa';
        th.style.fontSize = '11px';
        th.style.textAlign = 'center';
        th.style.whiteSpace = 'normal';
        th.style.wordBreak = 'break-word';
        th.style.lineHeight = '1.2';
        headerRow.appendChild(th);
      });
      table.appendChild(headerRow);
      
      // Create data rows
      labels.forEach((label, i) => {
        const row = document.createElement('tr');
        
        // Row label
        const rowLabel = document.createElement('td');
        rowLabel.textContent = label;
        rowLabel.style.border = '1px solid #ddd';
        rowLabel.style.padding = '8px';
        rowLabel.style.backgroundColor = '#f8f9fa';
        rowLabel.style.fontSize = '11px';
        rowLabel.style.fontWeight = 'bold';
        row.appendChild(rowLabel);
        
        // Data cells
        labels.forEach((_, j) => {
          const cell = document.createElement('td');
          const value = matrix[i][j];
          cell.textContent = value.toFixed(3);
          cell.style.border = '1px solid #ddd';
          cell.style.padding = '8px';
          cell.style.textAlign = 'center';
          cell.style.fontSize = '11px';
          cell.style.fontWeight = 'bold';
          
          // Color coding
          if (value < 0) {
            const intensity = Math.abs(value);
            const alpha = 0.3 + intensity * 0.7;
            cell.style.backgroundColor = `rgba(239, 68, 68, ${alpha})`;
            cell.style.color = intensity > 0.5 ? 'white' : 'black';
          } else if (value > 0) {
            const intensity = value;
            const alpha = 0.3 + intensity * 0.7;
            cell.style.backgroundColor = `rgba(59, 130, 246, ${alpha})`;
            cell.style.color = intensity > 0.5 ? 'white' : 'black';
          } else {
            cell.style.backgroundColor = 'rgba(156, 163, 175, 0.3)';
            cell.style.color = 'black';
          }
          
          // Tooltip
          cell.title = `${labels[i]} vs ${labels[j]}: ${value.toFixed(3)}`;
          row.appendChild(cell);
        });
        
        table.appendChild(row);
      });
      
      // Replace canvas with table
      container.replaceChild(table, canvas);
      
      // Add correlation statistics
      const stats = [];
      stats.push(`Event types: ${labels.length}`);
      stats.push(`Min correlation: ${corr.min_correlation.toFixed(3)}`);
      stats.push(`Max correlation: ${corr.max_correlation.toFixed(3)}`);
      
      // Find strongest positive and negative correlations
      let maxPos = -1, maxNeg = 1;
      let maxPosPair = '', maxNegPair = '';
      
      for (let i = 0; i < labels.length; i++) {
        for (let j = i + 1; j < labels.length; j++) {
          const corrValue = matrix[i][j];
          if (corrValue > maxPos) {
            maxPos = corrValue;
            maxPosPair = `${labels[i]} & ${labels[j]}`;
          }
          if (corrValue < maxNeg) {
            maxNeg = corrValue;
            maxNegPair = `${labels[i]} & ${labels[j]}`;
          }
        }
      }
      
      if (maxPosPair) stats.push(`Strongest positive: ${maxPosPair} (${maxPos.toFixed(3)})`);
      if (maxNegPair) stats.push(`Strongest negative: ${maxNegPair} (${maxNeg.toFixed(3)})`);

      document.getElementById('correlationMatrixStats').textContent = stats.join(' ‚Ä¢ ');
    })();

    // Maximum Severity Per Month Chart
    (() => {
      const maxSeverityData = {"months": ["2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06", "2025-07", "2025-08", "2025-09", "2025-10", "2025-11", "2025-12", "2026-01"], "severities": ["EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL", "EventSeverity.HIGH", "EventSeverity.CRITICAL"], "titles": ["Toll Group Ransomware Attack and Data Leak", "Fears private details of Defence Force members compromised in database hack", "Federal court data breach sees names of protection visa applicants made public", "Confidential details of entire WA Police Force accessed in 'startling' audit breach, CCC finds", "Australian Transport Company Hit with Nefilim Ransomware Months ...", "Lion Dairy & Drinks Ransomware Attack", "Garmin goes down after suspected ransomware attack", "Scattered Spider Ransomware Attacks Target Australian Healthcare Sector", "Booking.com, Expedia Group, Hotels.com customers in suspected data breach", "Gravatar profile add-on leaks data on millions of users", "Ransomware Attack on B&R Enclosures", "TfNSW finds more customers, employees impacted by Accellion breach", "Leaked employee credentials from Big Four Australian banks found on dark web", "Meat giant JBS pays $11m in ransom to resolve cyber-attack", "China suspected of cyber attack on Western Australia's Parliament ...", "South Australian Government Payroll Data Breach via Frontier Software Ransomware Attack", "BLK Sport DarkSide Ransomware Attack", "LinkedIn data from 700 million users for sale on hacking forum", "SonicWall devices at risk of ransomware, ACSC rings alarm bells ...", "The Good Guys customers possibly affected by data breach at former third-party provider My Rewards", "Cybersecurity experts weigh in on GoDaddy data breach", "Twitch hack reveals multi-million-dollar sums top streamers earn from playing computer games", "Refer compo spreadsheet data breach to privacy watchdog: ACT firies' union", "How the SA Government Data Breach was avoidable | InConsult", "Vinomofo did not protect personal information from security risks, Privacy Commissioner finds", "Medlab Pathology Ransomware/Data Breach Incident", "Significant Cyber Incidents | Strategic Technologies Program | CSIS", "TfNSW hit by second cyber attack in less than 18 months", "Leak of Nauru Police Force Files Related to Australian Offshore Processing", "Royal Flying Doctors Service's Rapid Ransomware Recovery ...", "Woolworths MyDeal Data Breach", "Australia Blames Russian Hacker for Major Cyber Attack - The ...", "AFP officer data leaked in cyber breach", "Australian Healthcare Under Cyber Attack: Adactin's Solution ...", "Privacy complaints | Queensland Health", "Data breach hits Victoria\u2019s revenue office", "Latitude Financial Services Data Breach", "Pound Road Medical Center Ransomware Attack", "Statement on reported data breach involving NSW driver licences", "HWL Ebsworth Cyber Security Incident", "FIIG Securities Cybersecurity Breach", "Dymocks warns customers of data breach after account information leaked on dark web", "Pizza Hut Australia Data Breach", "TissuPath data breach victim upset by delayed notification", "DP World Australia resumes operations after cyber-attack disruption ...", "Charity donor details\u2026 - Institute of Community Directors Australia", "Senior executives affected in largest observed Microsoft Azure data-theft campaign", "Nissan's Australian and New Zealand operations hit by cyber attack ...", "Print music giant Hal Leonard Australia falls victim to Qilin ransomware", "Untitled Event", "Raft of Australian companies compromised in hosting service hack", "Huge trove of Australian client data leaked following OracleCMS call centre hack", "Exclusive: Hacker claims successful hack of Adreno, the \u2018world\u2019s largest dive store\u2019", "Exclusive: Victorian IT services company Insula confirms BianLian ransomware attack", "Exclusive: Aussie engineering firm confirms RansomHub ransomware attack", "F5 Cybersecurity Breach Sparks National Security Concerns", "Internet Archive down, claims \u2018catastrophic\u2019 data breach impacting 31m", "Hertz says customers\u2019 personal data and driver\u2019s licenses stolen in data breach", "ARDEX Australia Cyber Attack", "Globelink International Ransomware Attack", "ARDEX Australia Medusa Ransomware Attack", "Australian Government Imposes Cyber Sanctions on Russian Entity for Facilitating Data Theft", "Vroom by YouX Fintech Data Breach", "AUD 500,000 Lost in Cyber Attack on Australian Superannuation ...", "O&G Adelaide Ransomware Leak", "Dragonforce Group Data Leak at Australian Engineering Firm", "Mercer Super reports security breach after Australia Post Melbourne ...", "Privacy Policy | Australian Dental Association", "Asahi Ransomware Attack", "Privacy | Queensland Fire Department", "INC Ransom ransomware attack on Facade Innovations", "List of Cyber Attacks and Data Breaches in Australia", "Hexicor KillSec Ransomware Breach"], "entities": ["Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity", "Unknown Entity"], "severity_numeric": [4, 3, 4, 3, 3, 4, 4, 4, 4, 3, 4, 3, 3, 4, 3, 3, 3, 3, 3, 3, 3, 4, 3, 4, 3, 4, 3, 3, 3, 3, 3, 4, 3, 4, 3, 3, 4, 4, 3, 4, 4, 3, 3, 3, 3, 3, 4, 4, 4, 3, 4, 4, 3, 4, 4, 4, 4, 3, 4, 4, 4, 4, 3, 4, 4, 4, 3, 3, 4, 3, 4, 3, 4], "avg_severity_numeric": [3.2, 2.89, 3.11, 3.0, 2.12, 2.4, 3.0, 2.71, 3.14, 2.0, 2.86, 2.71, 2.84, 2.9, 2.5, 2.4, 3.0, 2.67, 2.0, 3.0, 3.0, 2.5, 2.38, 3.0, 2.75, 2.73, 2.0, 2.67, 2.75, 2.0, 2.83, 2.73, 2.19, 2.33, 2.0, 2.62, 2.55, 2.33, 2.0, 2.4, 2.7, 2.6, 2.33, 2.57, 2.7, 2.5, 2.46, 2.5, 3.08, 3.0, 2.4, 2.88, 2.38, 2.67, 2.94, 3.11, 2.56, 1.93, 2.42, 3.11, 2.71, 2.12, 2.18, 2.47, 2.0, 2.5, 2.14, 2.35, 2.71, 2.12, 2.38, 3.0, 3.5]};
      new Chart(document.getElementById('maxSeverityChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: maxSeverityData.months,
          datasets: [{
            label: 'Maximum Severity',
            data: maxSeverityData.severity_numeric,
            borderColor: '#dc2626',
            backgroundColor: '#dc262620',
            fill: false,
            tension: 0.4,
            pointRadius: 6,
            pointHoverRadius: 8,
            borderWidth: 3
          }, {
            label: 'Average Severity',
            data: maxSeverityData.avg_severity_numeric,
            borderColor: '#f59e0b',
            backgroundColor: '#f59e0b20',
            fill: false,
            tension: 0.4,
            pointRadius: 4,
            pointHoverRadius: 6,
            borderWidth: 2,
            borderDash: [5, 5]
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: true, position: 'top' },
            tooltip: {
              callbacks: {
                title: function(tooltipItems) {
                  const index = tooltipItems[0].dataIndex;
                  return maxSeverityData.months[index];
                },
                label: function(tooltipItem) {
                  const index = tooltipItem.dataIndex;
                  const datasetLabel = tooltipItem.dataset.label;
                  if (datasetLabel === 'Maximum Severity') {
                    return `Maximum: ${maxSeverityData.severities[index]}`;
                  } else {
                    const avgValue = maxSeverityData.avg_severity_numeric[index];
                    const severityLabels = ['Unknown', 'Low', 'Medium', 'High', 'Critical'];
                    const nearestLabel = severityLabels[Math.round(avgValue)] || 'Unknown';
                    return `Average: ${nearestLabel} (${avgValue.toFixed(2)})`;
                  }
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              max: 4,
              ticks: {
                callback: function(value) {
                  const severityMap = {0: 'Unknown', 1: 'Low', 2: 'Medium', 3: 'High', 4: 'Critical'};
                  return severityMap[value] || value;
                }
              },
              title: { display: true, text: 'Severity Level' }
            },
            x: { title: { display: true, text: 'Month' } }
          }
        }
      });
    })();

    // 12) Maximum Records Affected Per Month
    (function() {
      const maxRecordsData = maxRecordsPerMonth;
      new Chart(document.getElementById('maxRecordsChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: maxRecordsData.months,
          datasets: [{
            label: 'Maximum Records Affected',
            data: maxRecordsData.max_records,
            borderColor: '#dc2626',
            backgroundColor: '#dc262620',
            fill: false,
            tension: 0.4,
            pointRadius: 6,
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                title: function(tooltipItems) {
                  const index = tooltipItems[0].dataIndex;
                  return maxRecordsData.titles[index] || 'Unknown Event';
                },
                label: function(tooltipItem) {
                  const index = tooltipItem.dataIndex;
                  const records = maxRecordsData.max_records[index];
                  return [
                    `Entity: ${maxRecordsData.entities[index]}`,
                    `Records: ${records.toLocaleString()}`
                  ];
                }
              }
            }
          },
          scales: {
            y: {
              type: 'logarithmic',
              beginAtZero: true,
              title: { display: true, text: 'Records Affected (log scale)' }
            },
            x: {
              title: { display: true, text: 'Month' }
            }
          }
        }
      });
    })();

    // Severity by Industry Radar Chart
    (() => {
      const severityByIndustry = {"industries": ["Technology", "Healthcare", "Government & Defense", "Others", "Financial Services", "Transportation", "Education", "Infrastructure", "Telecommunications", "Professional Services", "Not for Profit"], "avg_severities": [2.6533333333333333, 2.5859375, 2.485148514851485, 2.4468085106382977, 2.5280898876404496, 2.4482758620689653, 2.6923076923076925, 2.696969696969697, 2.8846153846153846, 2.12, 2.875], "no_data": false};

      // Check if there's no data (all Unknown industries)
      if (severityByIndustry.no_data || !severityByIndustry.industries || severityByIndustry.industries.length === 0) {
        const container = document.getElementById('severityByIndustryChart').parentElement;
        container.innerHTML =
          '<div class="chart-title">Average Severity by Industry</div>' +
          '<div class="text-center text-muted mt-5">' +
          '<p>No industry data available.</p>' +
          '<p style="font-size: 0.9rem;">The enrichment process has not yet populated industry information for events.</p>' +
          '</div>';
        return;
      }

      new Chart(document.getElementById('severityByIndustryChart').getContext('2d'), {
        type: 'radar',
        data: {
          labels: severityByIndustry.industries,
          datasets: [{
            label: 'Average Severity',
            data: severityByIndustry.avg_severities,
            backgroundColor: '#2563eb20',
            borderColor: '#2563eb',
            borderWidth: 2,
            pointBackgroundColor: '#2563eb',
            pointBorderColor: '#2563eb'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: {
            r: {
              beginAtZero: true,
              max: 4,
              ticks: {
                callback: function(value) {
                  const severityMap = {0: 'Unknown', 1: 'Low', 2: 'Medium', 3: 'High', 4: 'Critical'};
                  return severityMap[value] || value;
                }
              }
            }
          }
        }
      });
    })();

    // Severity by Attack Type Radar Chart
    (() => {
      const severityByAttackType = {"attack_types": ["Data Breach", "Denial Of Service", "Financial Fraud", "Identity Theft", "Infrastructure Attack", "Malware", "Other", "Phishing", "Ransomware", "State Sponsored Attack", "Supply Chain Attack", "Vulnerability Exploit"], "avg_severities": [2.8195876288659796, 3.0, 3.3333333333333335, 3.0, 2.923076923076923, 2.5454545454545454, 0.5304347826086957, 2.25, 3.064039408866995, 3.1666666666666665, 3.0, 3.0]};
      new Chart(document.getElementById('severityByAttackTypeChart').getContext('2d'), {
        type: 'radar',
        data: {
          labels: severityByAttackType.attack_types,
          datasets: [{
            label: 'Average Severity',
            data: severityByAttackType.avg_severities,
            backgroundColor: '#05966920',
            borderColor: '#059669',
            borderWidth: 2,
            pointBackgroundColor: '#059669',
            pointBorderColor: '#059669'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: {
            r: {
              beginAtZero: true,
              max: 4,
              ticks: {
                callback: function(value) {
                  const severityMap = {0: 'Unknown', 1: 'Low', 2: 'Medium', 3: 'High', 4: 'Critical'};
                  return severityMap[value] || value;
                }
              }
            }
          }
        }
      });
    })();

    // 13) Average Records Affected by Attack Type
    (function() {
      const recordsData = recordsByAttackType;
      new Chart(document.getElementById('recordsByAttackTypeChart').getContext('2d'), {
        type: 'bar',
        data: {
          labels: recordsData.attack_types,
          datasets: [{
            label: 'Average Records Affected',
            data: recordsData.avg_records,
            backgroundColor: '#7c3aed',
            borderColor: '#7c3aed',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          indexAxis: 'y',
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: function(tooltipItem) {
                  const value = tooltipItem.raw;
                  return `Average: ${value.toLocaleString(undefined, {maximumFractionDigits: 0})} records`;
                }
              }
            }
          },
          scales: {
            x: {
              type: 'logarithmic',
              beginAtZero: true,
              title: { display: true, text: 'Average Records Affected (log scale)' },
              ticks: {
                callback: function(value) {
                  return value.toLocaleString();
                }
              }
            },
            y: {
              title: { display: true, text: 'Attack Type' }
            }
          }
        }
      });
    })();
  </script>
</body>
</html>
